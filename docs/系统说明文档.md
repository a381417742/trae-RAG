# RAGçŸ¥è¯†åº“é—®ç­”ç³»ç»Ÿ - å®Œæ•´è¯´æ˜æ–‡æ¡£

## ğŸ“‹ ç›®å½•

1. [ç³»ç»Ÿæ¦‚è¿°](#1-ç³»ç»Ÿæ¦‚è¿°)
2. [åŠŸèƒ½ç‰¹æ€§](#2-åŠŸèƒ½ç‰¹æ€§)
3. [ç³»ç»Ÿæ¶æ„](#3-ç³»ç»Ÿæ¶æ„)
4. [æŠ€æœ¯å‚æ•°ä¸ç³»ç»Ÿè¦æ±‚](#4-æŠ€æœ¯å‚æ•°ä¸ç³»ç»Ÿè¦æ±‚)
5. [å®‰è£…éƒ¨ç½²æŒ‡å—](#5-å®‰è£…éƒ¨ç½²æŒ‡å—)
6. [ä½¿ç”¨æ“ä½œæŒ‡å—](#6-ä½¿ç”¨æ“ä½œæŒ‡å—)
7. [APIæ¥å£æ–‡æ¡£](#7-apiæ¥å£æ–‡æ¡£)
8. [å¸¸è§é—®é¢˜è§£å†³æ–¹æ¡ˆ](#8-å¸¸è§é—®é¢˜è§£å†³æ–¹æ¡ˆ)
9. [ç»´æŠ¤ä¸å‡çº§è¯´æ˜](#9-ç»´æŠ¤ä¸å‡çº§è¯´æ˜)
10. [æ€§èƒ½ä¼˜åŒ–å»ºè®®](#10-æ€§èƒ½ä¼˜åŒ–å»ºè®®)
11. [å®‰å…¨é…ç½®æŒ‡å—](#11-å®‰å…¨é…ç½®æŒ‡å—)
12. [æ•…éšœæ’é™¤æŒ‡å—](#12-æ•…éšœæ’é™¤æŒ‡å—)

---

## 1. ç³»ç»Ÿæ¦‚è¿°

### 1.1 äº§å“ç®€ä»‹

RAGçŸ¥è¯†åº“é—®ç­”ç³»ç»Ÿæ˜¯ä¸€ä¸ªåŸºäºæ£€ç´¢å¢å¼ºç”Ÿæˆï¼ˆRetrieval-Augmented Generationï¼‰æŠ€æœ¯çš„æ™ºèƒ½é—®ç­”å¹³å°ã€‚ç³»ç»Ÿç»“åˆäº†å‘é‡æ£€ç´¢å’Œå¤§è¯­è¨€æ¨¡å‹çš„ä¼˜åŠ¿ï¼Œèƒ½å¤ŸåŸºäºç”¨æˆ·ä¸Šä¼ çš„æ–‡æ¡£æ„å»ºä¸“å±çŸ¥è¯†åº“ï¼Œå¹¶æä¾›å‡†ç¡®ã€ç›¸å…³çš„æ™ºèƒ½é—®ç­”æœåŠ¡ã€‚

### 1.2 æ ¸å¿ƒä»·å€¼

- **ğŸ¯ ç²¾å‡†é—®ç­”**: åŸºäºç”¨æˆ·æ–‡æ¡£æä¾›å‡†ç¡®ã€ç›¸å…³çš„ç­”æ¡ˆ
- **ğŸš€ é«˜æ€§èƒ½**: æ”¯æŒé«˜å¹¶å‘è®¿é—®ï¼Œå“åº”æ—¶é—´å°äº3ç§’
- **ğŸ”§ æ˜“éƒ¨ç½²**: å®¹å™¨åŒ–éƒ¨ç½²ï¼Œæ”¯æŒæœ¬åœ°å’Œäº‘ç«¯ç¯å¢ƒ
- **ğŸ“Š å¯ç›‘æ§**: å®Œæ•´çš„ç›‘æ§æŒ‡æ ‡å’Œæ—¥å¿—ç³»ç»Ÿ
- **ğŸ”’ å®‰å…¨å¯é **: å¤šå±‚å®‰å…¨é˜²æŠ¤ï¼Œæ•°æ®éšç§ä¿æŠ¤

### 1.3 åº”ç”¨åœºæ™¯

- **ä¼ä¸šçŸ¥è¯†ç®¡ç†**: æ„å»ºä¼ä¸šå†…éƒ¨çŸ¥è¯†åº“ï¼Œæå‡ä¿¡æ¯æ£€ç´¢æ•ˆç‡
- **å®¢æˆ·æœåŠ¡**: åŸºäºäº§å“æ–‡æ¡£æä¾›æ™ºèƒ½å®¢æœæ”¯æŒ
- **æ•™è‚²åŸ¹è®­**: æ„å»ºå­¦ä¹ èµ„æ–™é—®ç­”ç³»ç»Ÿ
- **æŠ€æœ¯æ–‡æ¡£**: ä¸ºå¼€å‘å›¢é˜Ÿæä¾›æŠ€æœ¯æ–‡æ¡£æŸ¥è¯¢æœåŠ¡
- **æ³•å¾‹å’¨è¯¢**: åŸºäºæ³•å¾‹æ¡æ–‡æä¾›åˆæ­¥æ³•å¾‹å’¨è¯¢

### 1.4 ç³»ç»Ÿç‰¹ç‚¹

- **å¤šæ ¼å¼æ”¯æŒ**: æ”¯æŒPDFã€TXTã€MDã€DOCXç­‰å¤šç§æ–‡æ¡£æ ¼å¼
- **æ™ºèƒ½åˆ†å—**: è‡ªåŠ¨å°†é•¿æ–‡æ¡£åˆ†å‰²ä¸ºè¯­ä¹‰ç›¸å…³çš„å—
- **å‘é‡æ£€ç´¢**: ä½¿ç”¨å…ˆè¿›çš„åµŒå…¥æ¨¡å‹è¿›è¡Œè¯­ä¹‰æ£€ç´¢
- **ç¼“å­˜åŠ é€Ÿ**: Redisç¼“å­˜æå‡é—®ç­”å“åº”é€Ÿåº¦
- **è´Ÿè½½å‡è¡¡**: Nginxè´Ÿè½½å‡è¡¡æ”¯æŒé«˜å¹¶å‘è®¿é—®
- **ç›‘æ§å‘Šè­¦**: Prometheus + Grafanaç›‘æ§ç³»ç»Ÿ

---

## 2. åŠŸèƒ½ç‰¹æ€§

### 2.1 æ–‡æ¡£ç®¡ç†åŠŸèƒ½

#### 2.1.1 æ–‡æ¡£ä¸Šä¼ 
- **å•æ–‡ä»¶ä¸Šä¼ **: æ”¯æŒæ‹–æ‹½ä¸Šä¼ ï¼Œå®æ—¶è¿›åº¦æ˜¾ç¤º
- **æ‰¹é‡ä¸Šä¼ **: ä¸€æ¬¡æ€§ä¸Šä¼ å¤šä¸ªæ–‡æ¡£æ–‡ä»¶
- **æ ¼å¼éªŒè¯**: è‡ªåŠ¨æ£€æµ‹æ–‡ä»¶æ ¼å¼å’Œå¤§å°é™åˆ¶
- **é‡å¤æ£€æµ‹**: åŸºäºæ–‡ä»¶å“ˆå¸Œé¿å…é‡å¤ä¸Šä¼ 

#### 2.1.2 æ–‡æ¡£å¤„ç†
- **æ™ºèƒ½è§£æ**: è‡ªåŠ¨æå–æ–‡æ¡£æ–‡æœ¬å†…å®¹
- **è¯­ä¹‰åˆ†å—**: åŸºäºè¯­ä¹‰è¾¹ç•Œè¿›è¡Œæ–‡æ¡£åˆ†å‰²
- **å‘é‡åŒ–**: ç”Ÿæˆé«˜è´¨é‡çš„æ–‡æ¡£åµŒå…¥å‘é‡
- **å¢é‡æ›´æ–°**: æ”¯æŒæ–‡æ¡£çš„å¢é‡å¤„ç†å’Œæ›´æ–°

#### 2.1.3 æ–‡æ¡£ç®¡ç†
- **æ–‡æ¡£åˆ—è¡¨**: æŸ¥çœ‹å·²ä¸Šä¼ æ–‡æ¡£çš„è¯¦ç»†ä¿¡æ¯
- **æ–‡æ¡£åˆ é™¤**: å®‰å…¨åˆ é™¤æ–‡æ¡£åŠç›¸å…³å‘é‡æ•°æ®
- **å¤„ç†çŠ¶æ€**: å®æ—¶æŸ¥çœ‹æ–‡æ¡£å¤„ç†è¿›åº¦
- **ç»Ÿè®¡ä¿¡æ¯**: æ–‡æ¡£æ•°é‡ã€å­˜å‚¨ç©ºé—´ç­‰ç»Ÿè®¡

### 2.2 æ™ºèƒ½é—®ç­”åŠŸèƒ½

#### 2.2.1 é—®ç­”æœåŠ¡
- **å•é—®é¢˜é—®ç­”**: åŸºäºçŸ¥è¯†åº“å›ç­”å•ä¸ªé—®é¢˜
- **æ‰¹é‡é—®ç­”**: ä¸€æ¬¡æ€§å¤„ç†å¤šä¸ªé—®é¢˜
- **æµå¼é—®ç­”**: å®æ—¶æµå¼è¿”å›ç­”æ¡ˆå†…å®¹
- **ä¸Šä¸‹æ–‡ç†è§£**: ç†è§£é—®é¢˜ä¸Šä¸‹æ–‡ï¼Œæä¾›å‡†ç¡®ç­”æ¡ˆ

#### 2.2.2 æ£€ç´¢ä¼˜åŒ–
- **è¯­ä¹‰æ£€ç´¢**: åŸºäºè¯­ä¹‰ç›¸ä¼¼åº¦è¿›è¡Œæ–‡æ¡£æ£€ç´¢
- **ç›¸ä¼¼åº¦é˜ˆå€¼**: å¯é…ç½®çš„ç›¸ä¼¼åº¦è¿‡æ»¤é˜ˆå€¼
- **æ£€ç´¢æ•°é‡**: å¯è°ƒèŠ‚çš„æ£€ç´¢æ–‡æ¡£æ•°é‡
- **ç»“æœæ’åº**: æŒ‰ç›¸ä¼¼åº¦å’Œç›¸å…³æ€§æ’åº

#### 2.2.3 ç­”æ¡ˆç”Ÿæˆ
- **å¤§æ¨¡å‹ç”Ÿæˆ**: ä½¿ç”¨Qwen3:30Bæ¨¡å‹ç”Ÿæˆç­”æ¡ˆ
- **ä¸Šä¸‹æ–‡èåˆ**: ç»“åˆæ£€ç´¢åˆ°çš„æ–‡æ¡£ç”Ÿæˆç­”æ¡ˆ
- **ç­”æ¡ˆè´¨é‡**: ç¡®ä¿ç­”æ¡ˆçš„å‡†ç¡®æ€§å’Œç›¸å…³æ€§
- **å¼•ç”¨æ ‡æ³¨**: æ ‡æ³¨ç­”æ¡ˆæ¥æºæ–‡æ¡£

### 2.3 ç³»ç»Ÿç®¡ç†åŠŸèƒ½

#### 2.3.1 ç³»ç»Ÿç›‘æ§
- **å¥åº·æ£€æŸ¥**: å®æ—¶ç›‘æ§ç³»ç»Ÿå„ç»„ä»¶çŠ¶æ€
- **æ€§èƒ½æŒ‡æ ‡**: CPUã€å†…å­˜ã€ç£ç›˜ä½¿ç”¨ç‡ç›‘æ§
- **ä¸šåŠ¡æŒ‡æ ‡**: é—®ç­”æˆåŠŸç‡ã€å“åº”æ—¶é—´ç­‰
- **å‘Šè­¦é€šçŸ¥**: å¼‚å¸¸æƒ…å†µè‡ªåŠ¨å‘Šè­¦

#### 2.3.2 é…ç½®ç®¡ç†
- **å‚æ•°é…ç½®**: åœ¨çº¿è°ƒæ•´ç³»ç»Ÿå‚æ•°
- **æ¨¡å‹é…ç½®**: åˆ‡æ¢å’Œé…ç½®è¯­è¨€æ¨¡å‹
- **ç¼“å­˜é…ç½®**: è°ƒæ•´ç¼“å­˜ç­–ç•¥å’Œè¿‡æœŸæ—¶é—´
- **å®‰å…¨é…ç½®**: APIå¯†é’¥ã€è®¿é—®æ§åˆ¶ç­‰

#### 2.3.3 æ—¥å¿—ç®¡ç†
- **è®¿é—®æ—¥å¿—**: è®°å½•æ‰€æœ‰APIè®¿é—®æ—¥å¿—
- **é”™è¯¯æ—¥å¿—**: è¯¦ç»†çš„é”™è¯¯ä¿¡æ¯å’Œå †æ ˆè·Ÿè¸ª
- **ä¸šåŠ¡æ—¥å¿—**: æ–‡æ¡£å¤„ç†ã€é—®ç­”ç­‰ä¸šåŠ¡æ—¥å¿—
- **æ—¥å¿—è½®è½¬**: è‡ªåŠ¨æ—¥å¿—è½®è½¬å’Œæ¸…ç†

### 2.4 é«˜çº§åŠŸèƒ½

#### 2.4.1 ç¼“å­˜ç³»ç»Ÿ
- **æ™ºèƒ½ç¼“å­˜**: è‡ªåŠ¨ç¼“å­˜çƒ­é—¨é—®é¢˜ç­”æ¡ˆ
- **ç¼“å­˜ç­–ç•¥**: å¯é…ç½®çš„ç¼“å­˜è¿‡æœŸç­–ç•¥
- **ç¼“å­˜ç»Ÿè®¡**: ç¼“å­˜å‘½ä¸­ç‡å’Œæ€§èƒ½ç»Ÿè®¡
- **ç¼“å­˜ç®¡ç†**: æ‰‹åŠ¨æ¸…ç†å’Œåˆ·æ–°ç¼“å­˜

#### 2.4.2 è´Ÿè½½å‡è¡¡
- **è¯·æ±‚åˆ†å‘**: æ™ºèƒ½åˆ†å‘ç”¨æˆ·è¯·æ±‚
- **å¥åº·æ£€æŸ¥**: è‡ªåŠ¨æ£€æµ‹åç«¯æœåŠ¡çŠ¶æ€
- **æ•…éšœè½¬ç§»**: è‡ªåŠ¨æ•…éšœè½¬ç§»å’Œæ¢å¤
- **æ€§èƒ½ä¼˜åŒ–**: è¿æ¥å¤ç”¨å’Œå‹ç¼©ä¼˜åŒ–

#### 2.4.3 å®‰å…¨é˜²æŠ¤
- **è¾“å…¥éªŒè¯**: ä¸¥æ ¼çš„è¾“å…¥å‚æ•°éªŒè¯
- **è®¿é—®æ§åˆ¶**: APIå¯†é’¥è®¤è¯å’Œæƒé™æ§åˆ¶
- **å®‰å…¨å¤´éƒ¨**: å®Œæ•´çš„HTTPå®‰å…¨å¤´éƒ¨
- **æ”»å‡»é˜²æŠ¤**: SQLæ³¨å…¥ã€XSSç­‰æ”»å‡»é˜²æŠ¤

---

## 3. ç³»ç»Ÿæ¶æ„

### 3.1 æ•´ä½“æ¶æ„

```mermaid
graph TB
    subgraph "ç”¨æˆ·å±‚"
        A[Webç•Œé¢] --> B[APIç½‘å…³]
        C[ç§»åŠ¨ç«¯] --> B
        D[ç¬¬ä¸‰æ–¹åº”ç”¨] --> B
    end
    
    subgraph "æ¥å…¥å±‚"
        B --> E[Nginxè´Ÿè½½å‡è¡¡]
        E --> F[FastAPIåº”ç”¨]
    end
    
    subgraph "ä¸šåŠ¡å±‚"
        F --> G[RAGå¼•æ“]
        G --> H[æ–‡æ¡£å¤„ç†å™¨]
        G --> I[é—®ç­”å¤„ç†å™¨]
    end
    
    subgraph "æ•°æ®å±‚"
        H --> J[Chromaå‘é‡æ•°æ®åº“]
        I --> J
        I --> K[Redisç¼“å­˜]
        F --> L[æ–‡ä»¶å­˜å‚¨]
    end
    
    subgraph "AIæœåŠ¡å±‚"
        H --> M[BGEåµŒå…¥æ¨¡å‹]
        I --> N[Qwen3å¤§è¯­è¨€æ¨¡å‹]
    end
    
    subgraph "ç›‘æ§å±‚"
        O[Prometheus] --> P[Grafana]
        F --> O
        E --> O
    end
```

### 3.2 æ ¸å¿ƒç»„ä»¶

#### 3.2.1 FastAPIåº”ç”¨æœåŠ¡
- **èŒè´£**: æä¾›RESTful APIæ¥å£
- **ç‰¹æ€§**: å¼‚æ­¥å¤„ç†ã€è‡ªåŠ¨æ–‡æ¡£ç”Ÿæˆã€æ•°æ®éªŒè¯
- **ç«¯å£**: 8000 (HTTP), 8001 (Metrics)

#### 3.2.2 RAGå¼•æ“
- **èŒè´£**: æ ¸å¿ƒä¸šåŠ¡é€»è¾‘å¤„ç†
- **ç»„ä»¶**: æ–‡æ¡£å¤„ç†å™¨ã€é—®ç­”å¤„ç†å™¨
- **ç‰¹æ€§**: å¼‚æ­¥å¤„ç†ã€é”™è¯¯æ¢å¤ã€æŒ‡æ ‡æ”¶é›†

#### 3.2.3 å‘é‡æ•°æ®åº“ (Chroma)
- **èŒè´£**: å­˜å‚¨æ–‡æ¡£å‘é‡å’Œå…ƒæ•°æ®
- **ç‰¹æ€§**: é«˜æ€§èƒ½æ£€ç´¢ã€æŒä¹…åŒ–å­˜å‚¨
- **ç«¯å£**: 8002

#### 3.2.4 ç¼“å­˜ç³»ç»Ÿ (Redis)
- **èŒè´£**: ç¼“å­˜é—®ç­”ç»“æœå’Œä¼šè¯æ•°æ®
- **ç‰¹æ€§**: é«˜é€Ÿè¯»å†™ã€è¿‡æœŸç­–ç•¥
- **ç«¯å£**: 6379

#### 3.2.5 è´Ÿè½½å‡è¡¡ (Nginx)
- **èŒè´£**: è¯·æ±‚åˆ†å‘å’Œåå‘ä»£ç†
- **ç‰¹æ€§**: é«˜å¹¶å‘ã€SSLç»ˆæ­¢ã€å‹ç¼©
- **ç«¯å£**: 80 (HTTP), 443 (HTTPS)

#### 2.4.2 è´Ÿè½½å‡è¡¡
- **è¯·æ±‚åˆ†å‘**: æ™ºèƒ½åˆ†å‘ç”¨æˆ·è¯·æ±‚
- **å¥åº·æ£€æŸ¥**: è‡ªåŠ¨æ£€æµ‹åç«¯æœåŠ¡çŠ¶æ€
- **æ•…éšœè½¬ç§»**: è‡ªåŠ¨æ•…éšœè½¬ç§»å’Œæ¢å¤
- **æ€§èƒ½ä¼˜åŒ–**: è¿æ¥å¤ç”¨å’Œå‹ç¼©ä¼˜åŒ–

#### 2.4.3 å®‰å…¨é˜²æŠ¤
- **è¾“å…¥éªŒè¯**: ä¸¥æ ¼çš„è¾“å…¥å‚æ•°éªŒè¯
- **è®¿é—®æ§åˆ¶**: APIå¯†é’¥è®¤è¯å’Œæƒé™æ§åˆ¶
- **å®‰å…¨å¤´éƒ¨**: å®Œæ•´çš„HTTPå®‰å…¨å¤´éƒ¨
- **æ”»å‡»é˜²æŠ¤**: SQLæ³¨å…¥ã€XSSç­‰æ”»å‡»é˜²æŠ¤

---

## 3. ç³»ç»Ÿæ¶æ„

### 3.1 æ•´ä½“æ¶æ„

```mermaid
graph TB
    subgraph "ç”¨æˆ·å±‚"
        A[Webç•Œé¢] --> B[APIç½‘å…³]
        C[ç§»åŠ¨ç«¯] --> B
        D[ç¬¬ä¸‰æ–¹åº”ç”¨] --> B
    end
    
    subgraph "æ¥å…¥å±‚"
        B --> E[Nginxè´Ÿè½½å‡è¡¡]
        E --> F[FastAPIåº”ç”¨]
    end
    
    subgraph "ä¸šåŠ¡å±‚"
        F --> G[RAGå¼•æ“]
        G --> H[æ–‡æ¡£å¤„ç†å™¨]
        G --> I[é—®ç­”å¤„ç†å™¨]
    end
    
    subgraph "æ•°æ®å±‚"
        H --> J[Chromaå‘é‡æ•°æ®åº“]
        I --> J
        I --> K[Redisç¼“å­˜]
        F --> L[æ–‡ä»¶å­˜å‚¨]
    end
    
    subgraph "AIæœåŠ¡å±‚"
        H --> M[BGEåµŒå…¥æ¨¡å‹]
        I --> N[Qwen3å¤§è¯­è¨€æ¨¡å‹]
    end
    
    subgraph "ç›‘æ§å±‚"
        O[Prometheus] --> P[Grafana]
        F --> O
        E --> O
    end
```

### 3.2 æ ¸å¿ƒç»„ä»¶

#### 3.2.1 FastAPIåº”ç”¨æœåŠ¡
- **èŒè´£**: æä¾›RESTful APIæ¥å£
- **ç‰¹æ€§**: å¼‚æ­¥å¤„ç†ã€è‡ªåŠ¨æ–‡æ¡£ç”Ÿæˆã€æ•°æ®éªŒè¯
- **ç«¯å£**: 8000 (HTTP), 8001 (Metrics)

#### 3.2.2 RAGå¼•æ“
- **èŒè´£**: æ ¸å¿ƒä¸šåŠ¡é€»è¾‘å¤„ç†
- **ç»„ä»¶**: æ–‡æ¡£å¤„ç†å™¨ã€é—®ç­”å¤„ç†å™¨
- **ç‰¹æ€§**: å¼‚æ­¥å¤„ç†ã€é”™è¯¯æ¢å¤ã€æŒ‡æ ‡æ”¶é›†

#### 3.2.3 å‘é‡æ•°æ®åº“ (Chroma)
- **èŒè´£**: å­˜å‚¨æ–‡æ¡£å‘é‡å’Œå…ƒæ•°æ®
- **ç‰¹æ€§**: é«˜æ€§èƒ½æ£€ç´¢ã€æŒä¹…åŒ–å­˜å‚¨
- **ç«¯å£**: 8002

#### 3.2.4 ç¼“å­˜ç³»ç»Ÿ (Redis)
- **èŒè´£**: ç¼“å­˜é—®ç­”ç»“æœå’Œä¼šè¯æ•°æ®
- **ç‰¹æ€§**: é«˜é€Ÿè¯»å†™ã€è¿‡æœŸç­–ç•¥
- **ç«¯å£**: 6379

#### 3.2.5 è´Ÿè½½å‡è¡¡ (Nginx)
- **èŒè´£**: è¯·æ±‚åˆ†å‘å’Œåå‘ä»£ç†
- **ç‰¹æ€§**: é«˜å¹¶å‘ã€SSLç»ˆæ­¢ã€å‹ç¼©
- **ç«¯å£**: 80 (HTTP), 443 (HTTPS)

### 3.3 æ•°æ®æµç¨‹

#### 3.3.1 æ–‡æ¡£å¤„ç†æµç¨‹
```mermaid
sequenceDiagram
    participant U as ç”¨æˆ·
    participant A as FastAPI
    participant R as RAGå¼•æ“
    participant D as æ–‡æ¡£å¤„ç†å™¨
    participant E as åµŒå…¥æ¨¡å‹
    participant V as å‘é‡æ•°æ®åº“
    
    U->>A: ä¸Šä¼ æ–‡æ¡£
    A->>R: å¤„ç†æ–‡æ¡£è¯·æ±‚
    R->>D: åŠ è½½æ–‡æ¡£
    D->>D: æ–‡æ¡£åˆ†å—
    D->>E: ç”ŸæˆåµŒå…¥å‘é‡
    E-->>D: è¿”å›å‘é‡
    D->>V: å­˜å‚¨å‘é‡å’Œå…ƒæ•°æ®
    V-->>D: ç¡®è®¤å­˜å‚¨
    D-->>R: å¤„ç†å®Œæˆ
    R-->>A: è¿”å›ç»“æœ
    A-->>U: å¤„ç†æˆåŠŸ
```

#### 3.3.2 é—®ç­”å¤„ç†æµç¨‹
```mermaid
sequenceDiagram
    participant U as ç”¨æˆ·
    participant A as FastAPI
    participant R as RAGå¼•æ“
    participant Q as é—®ç­”å¤„ç†å™¨
    participant C as ç¼“å­˜
    participant E as åµŒå…¥æ¨¡å‹
    participant V as å‘é‡æ•°æ®åº“
    participant L as å¤§è¯­è¨€æ¨¡å‹
    
    U->>A: æé—®
    A->>R: é—®ç­”è¯·æ±‚
    R->>Q: å¤„ç†é—®é¢˜
    Q->>C: æ£€æŸ¥ç¼“å­˜
    alt ç¼“å­˜å‘½ä¸­
        C-->>Q: è¿”å›ç¼“å­˜ç­”æ¡ˆ
    else ç¼“å­˜æœªå‘½ä¸­
        Q->>E: ç”Ÿæˆé—®é¢˜å‘é‡
        E-->>Q: è¿”å›å‘é‡
        Q->>V: æ£€ç´¢ç›¸å…³æ–‡æ¡£
        V-->>Q: è¿”å›æ–‡æ¡£
        Q->>L: ç”Ÿæˆç­”æ¡ˆ
        L-->>Q: è¿”å›ç­”æ¡ˆ
        Q->>C: ç¼“å­˜ç­”æ¡ˆ
    end
    Q-->>R: è¿”å›ç­”æ¡ˆ
    R-->>A: è¿”å›ç»“æœ
    A-->>U: ç­”æ¡ˆå“åº”
```

### 3.4 éƒ¨ç½²æ¶æ„

#### 3.4.1 å•æœºéƒ¨ç½²
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              æœåŠ¡å™¨                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Nginx (80/443)                     â”‚
â”‚  â”œâ”€â”€ FastAPI (8000)                 â”‚
â”‚  â”œâ”€â”€ Chroma (8002)                  â”‚
â”‚  â”œâ”€â”€ Redis (6379)                   â”‚
â”‚  â”œâ”€â”€ Ollama (11434)                 â”‚
â”‚  â””â”€â”€ Prometheus (9090)              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### 3.4.2 åˆ†å¸ƒå¼éƒ¨ç½²
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  è´Ÿè½½å‡è¡¡    â”‚    â”‚  åº”ç”¨æœåŠ¡    â”‚    â”‚  æ•°æ®æœåŠ¡    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Nginx       â”‚    â”‚ FastAPI     â”‚    â”‚ Chroma      â”‚
â”‚             â”‚    â”‚ RAG Engine  â”‚    â”‚ Redis       â”‚
â”‚             â”‚    â”‚             â”‚    â”‚ Ollama      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 4. æŠ€æœ¯å‚æ•°ä¸ç³»ç»Ÿè¦æ±‚

### 4.1 ç³»ç»Ÿè¦æ±‚

#### 4.1.1 ç¡¬ä»¶è¦æ±‚

**æœ€ä½é…ç½®**:
- CPU: 4æ ¸å¿ƒ 2.0GHz
- å†…å­˜: 8GB RAM
- å­˜å‚¨: 50GB å¯ç”¨ç©ºé—´
- ç½‘ç»œ: 100Mbps

**æ¨èé…ç½®**:
- CPU: 8æ ¸å¿ƒ 3.0GHz (æ”¯æŒAVX2)
- å†…å­˜: 16GB RAM
- å­˜å‚¨: 200GB SSD
- GPU: NVIDIA RTX 3060 æˆ–æ›´é«˜ (å¯é€‰)
- ç½‘ç»œ: 1Gbps

**ç”Ÿäº§ç¯å¢ƒ**:
- CPU: 16æ ¸å¿ƒ 3.5GHz
- å†…å­˜: 32GB RAM
- å­˜å‚¨: 500GB NVMe SSD
- GPU: NVIDIA RTX 4090 æˆ– A100
- ç½‘ç»œ: 10Gbps

#### 3.3.1 æ–‡æ¡£å¤„ç†æµç¨‹
```mermaid
sequenceDiagram
    participant U as ç”¨æˆ·
    participant A as FastAPI
    participant R as RAGå¼•æ“
    participant D as æ–‡æ¡£å¤„ç†å™¨
    participant E as åµŒå…¥æ¨¡å‹
    participant V as å‘é‡æ•°æ®åº“
    
    U->>A: ä¸Šä¼ æ–‡æ¡£
    A->>R: å¤„ç†æ–‡æ¡£è¯·æ±‚
    R->>D: åŠ è½½æ–‡æ¡£
    D->>D: æ–‡æ¡£åˆ†å—
    D->>E: ç”ŸæˆåµŒå…¥å‘é‡
    E-->>D: è¿”å›å‘é‡
    D->>V: å­˜å‚¨å‘é‡å’Œå…ƒæ•°æ®
    V-->>D: ç¡®è®¤å­˜å‚¨
    D-->>R: å¤„ç†å®Œæˆ
    R-->>A: è¿”å›ç»“æœ
    A-->>U: å¤„ç†æˆåŠŸ
```

#### 3.3.2 é—®ç­”å¤„ç†æµç¨‹
```mermaid
sequenceDiagram
    participant U as ç”¨æˆ·
    participant A as FastAPI
    participant R as RAGå¼•æ“
    participant Q as é—®ç­”å¤„ç†å™¨
    participant C as ç¼“å­˜
    participant E as åµŒå…¥æ¨¡å‹
    participant V as å‘é‡æ•°æ®åº“
    participant L as å¤§è¯­è¨€æ¨¡å‹
    
    U->>A: æé—®
    A->>R: é—®ç­”è¯·æ±‚
    R->>Q: å¤„ç†é—®é¢˜
    Q->>C: æ£€æŸ¥ç¼“å­˜
    alt ç¼“å­˜å‘½ä¸­
        C-->>Q: è¿”å›ç¼“å­˜ç­”æ¡ˆ
    else ç¼“å­˜æœªå‘½ä¸­
        Q->>E: ç”Ÿæˆé—®é¢˜å‘é‡
        E-->>Q: è¿”å›å‘é‡
        Q->>V: æ£€ç´¢ç›¸å…³æ–‡æ¡£
        V-->>Q: è¿”å›æ–‡æ¡£
        Q->>L: ç”Ÿæˆç­”æ¡ˆ
        L-->>Q: è¿”å›ç­”æ¡ˆ
        Q->>C: ç¼“å­˜ç­”æ¡ˆ
    end
    Q-->>R: è¿”å›ç­”æ¡ˆ
    R-->>A: è¿”å›ç»“æœ
    A-->>U: ç­”æ¡ˆå“åº”
```

### 3.4 éƒ¨ç½²æ¶æ„

#### 3.4.1 å•æœºéƒ¨ç½²
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              æœåŠ¡å™¨                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Nginx (80/443)                     â”‚
â”‚  â”œâ”€â”€ FastAPI (8000)                 â”‚
â”‚  â”œâ”€â”€ Chroma (8002)                  â”‚
â”‚  â”œâ”€â”€ Redis (6379)                   â”‚
â”‚  â”œâ”€â”€ Ollama (11434)                 â”‚
â”‚  â””â”€â”€ Prometheus (9090)              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### 3.4.2 åˆ†å¸ƒå¼éƒ¨ç½²
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  è´Ÿè½½å‡è¡¡    â”‚    â”‚  åº”ç”¨æœåŠ¡    â”‚    â”‚  æ•°æ®æœåŠ¡    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Nginx       â”‚    â”‚ FastAPI     â”‚    â”‚ Chroma      â”‚
â”‚             â”‚    â”‚ RAG Engine  â”‚    â”‚ Redis       â”‚
â”‚             â”‚    â”‚             â”‚    â”‚ Ollama      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 4. æŠ€æœ¯å‚æ•°ä¸ç³»ç»Ÿè¦æ±‚

### 4.1 ç³»ç»Ÿè¦æ±‚

#### 4.1.1 ç¡¬ä»¶è¦æ±‚

**æœ€ä½é…ç½®**:
- CPU: 4æ ¸å¿ƒ 2.0GHz
- å†…å­˜: 8GB RAM
- å­˜å‚¨: 50GB å¯ç”¨ç©ºé—´
- ç½‘ç»œ: 100Mbps

**æ¨èé…ç½®**:
- CPU: 8æ ¸å¿ƒ 3.0GHz (æ”¯æŒAVX2)
- å†…å­˜: 16GB RAM
- å­˜å‚¨: 200GB SSD
- GPU: NVIDIA RTX 3060 æˆ–æ›´é«˜ (å¯é€‰)
- ç½‘ç»œ: 1Gbps

**ç”Ÿäº§ç¯å¢ƒ**:
- CPU: 16æ ¸å¿ƒ 3.5GHz
- å†…å­˜: 32GB RAM
- å­˜å‚¨: 500GB NVMe SSD
- GPU: NVIDIA RTX 4090 æˆ– A100
- ç½‘ç»œ: 10Gbps

#### 4.1.2 è½¯ä»¶è¦æ±‚

**æ“ä½œç³»ç»Ÿ**:
- Ubuntu 20.04+ / CentOS 8+ / RHEL 8+
- macOS 12+ (å¼€å‘ç¯å¢ƒ)
- Windows 10+ (å¼€å‘ç¯å¢ƒ)

**å®¹å™¨ç¯å¢ƒ**:
- Docker 20.10+
- Docker Compose 2.0+

**Pythonç¯å¢ƒ**:
- Python 3.9+
- pip 21.0+

### 4.2 æ€§èƒ½å‚æ•°

#### 4.2.1 å¤„ç†èƒ½åŠ›

| æŒ‡æ ‡ | æ•°å€¼ | è¯´æ˜ |
|------|------|------|
| å¹¶å‘ç”¨æˆ·æ•° | 1000+ | åŒæ—¶åœ¨çº¿ç”¨æˆ·æ•° |
| QPS | 100+ | æ¯ç§’æŸ¥è¯¢æ•° |
| å“åº”æ—¶é—´ | <3ç§’ | å¹³å‡é—®ç­”å“åº”æ—¶é—´ |
| æ–‡æ¡£å¤„ç†é€Ÿåº¦ | 10MB/åˆ†é’Ÿ | æ–‡æ¡£å‘é‡åŒ–é€Ÿåº¦ |
| å­˜å‚¨å®¹é‡ | 100GB+ | æ”¯æŒçš„æ–‡æ¡£å­˜å‚¨é‡ |

#### 4.2.2 å¯ç”¨æ€§æŒ‡æ ‡

| æŒ‡æ ‡ | ç›®æ ‡å€¼ | è¯´æ˜ |
|------|--------|------|
| ç³»ç»Ÿå¯ç”¨æ€§ | 99.9% | å¹´åº¦å¯ç”¨æ—¶é—´ |
| æ•…éšœæ¢å¤æ—¶é—´ | <5åˆ†é’Ÿ | å¹³å‡æ•…éšœæ¢å¤æ—¶é—´ |
| æ•°æ®å¤‡ä»½é¢‘ç‡ | æ¯æ—¥ | è‡ªåŠ¨æ•°æ®å¤‡ä»½ |
| ç›‘æ§è¦†ç›–ç‡ | 100% | å…³é”®ç»„ä»¶ç›‘æ§è¦†ç›– |

### 4.3 æŠ€æœ¯æ ˆ

#### 4.3.1 åç«¯æŠ€æœ¯

| ç»„ä»¶ | æŠ€æœ¯ | ç‰ˆæœ¬ | è¯´æ˜ |
|------|------|------|------|
| Webæ¡†æ¶ | FastAPI | 0.104+ | é«˜æ€§èƒ½å¼‚æ­¥Webæ¡†æ¶ |
| è¯­è¨€æ¨¡å‹ | Qwen3 | 30B | å¤§è¯­è¨€æ¨¡å‹ |
| åµŒå…¥æ¨¡å‹ | BGE-Large-ZH | v1.5 | ä¸­æ–‡åµŒå…¥æ¨¡å‹ |
| å‘é‡æ•°æ®åº“ | Chroma | 0.4+ | å‘é‡å­˜å‚¨å’Œæ£€ç´¢ |
| ç¼“å­˜ | Redis | 7.2+ | å†…å­˜æ•°æ®åº“ |
| è´Ÿè½½å‡è¡¡ | Nginx | 1.25+ | åå‘ä»£ç†æœåŠ¡å™¨ |

#### 4.3.2 AI/MLæŠ€æœ¯

| ç»„ä»¶ | æŠ€æœ¯ | è¯´æ˜ |
|------|------|------|
| æ–‡æ¡£è§£æ | LangChain | æ–‡æ¡£åŠ è½½å’Œå¤„ç† |
| æ–‡æœ¬åˆ†å‰² | RecursiveCharacterTextSplitter | æ™ºèƒ½æ–‡æœ¬åˆ†å— |
| å‘é‡æ£€ç´¢ | Cosine Similarity | ä½™å¼¦ç›¸ä¼¼åº¦æ£€ç´¢ |
| æ¨¡å‹æ¨ç† | Ollama | æœ¬åœ°æ¨¡å‹æ¨ç†æœåŠ¡ |

#### 4.3.3 ç›‘æ§è¿ç»´

| ç»„ä»¶ | æŠ€æœ¯ | è¯´æ˜ |
|------|------|------|
| æŒ‡æ ‡æ”¶é›† | Prometheus | ç³»ç»ŸæŒ‡æ ‡ç›‘æ§ |
| å¯è§†åŒ– | Grafana | ç›‘æ§ä»ªè¡¨æ¿ |
| æ—¥å¿—ç®¡ç† | Loguru | ç»“æ„åŒ–æ—¥å¿— |
| å®¹å™¨åŒ– | Docker | åº”ç”¨å®¹å™¨åŒ– |

### 4.4 ç½‘ç»œè¦æ±‚

#### 4.4.1 ç«¯å£é…ç½®

| æœåŠ¡ | ç«¯å£ | åè®® | è¯´æ˜ |
|------|------|------|------|
| Nginx | 80 | HTTP | WebæœåŠ¡ |
| Nginx | 443 | HTTPS | å®‰å…¨WebæœåŠ¡ |
| FastAPI | 8000 | HTTP | APIæœåŠ¡ |
| FastAPI Metrics | 8001 | HTTP | ç›‘æ§æŒ‡æ ‡ |
| Chroma | 8002 | HTTP | å‘é‡æ•°æ®åº“ |
| Redis | 6379 | TCP | ç¼“å­˜æœåŠ¡ |
| Ollama | 11434 | HTTP | æ¨¡å‹æ¨ç†æœåŠ¡ |
| Prometheus | 9090 | HTTP | ç›‘æ§æœåŠ¡ |
| Grafana | 3000 | HTTP | å¯è§†åŒ–æœåŠ¡ |

#### 4.4.2 å®‰å…¨é…ç½®

| é…ç½®é¡¹ | å»ºè®®å€¼ | è¯´æ˜ |
|--------|--------|------|
| é˜²ç«å¢™ | å¯ç”¨ | åªå¼€æ”¾å¿…è¦ç«¯å£ |
| SSL/TLS | TLS 1.2+ | åŠ å¯†ä¼ è¾“ |
| APIè®¤è¯ | å¯ç”¨ | APIå¯†é’¥è®¤è¯ |
| è®¿é—®æ—¥å¿— | å¯ç”¨ | è®°å½•è®¿é—®æ—¥å¿— |
| é€Ÿç‡é™åˆ¶ | 100/åˆ†é’Ÿ | é˜²æ­¢æ»¥ç”¨ |

---

## 8. å¸¸è§é—®é¢˜è§£å†³æ–¹æ¡ˆ

### 8.1 å®‰è£…éƒ¨ç½²é—®é¢˜

#### 8.1.1 Dockerå®‰è£…å¤±è´¥

**é—®é¢˜**: Dockerå®‰è£…è¿‡ç¨‹ä¸­å‡ºç°æƒé™é”™è¯¯

**è§£å†³æ–¹æ¡ˆ**:
```bash
# æ·»åŠ ç”¨æˆ·åˆ°dockerç»„
sudo usermod -aG docker $USER

# é‡æ–°ç™»å½•æˆ–æ‰§è¡Œ
newgrp docker

# éªŒè¯å®‰è£…
docker run hello-world
```

#### 8.1.2 å®¹å™¨å¯åŠ¨å¤±è´¥

**é—®é¢˜**: å®¹å™¨å¯åŠ¨æ—¶ç«¯å£å†²çª

**è§£å†³æ–¹æ¡ˆ**:
```bash
# æ£€æŸ¥ç«¯å£å ç”¨
sudo netstat -tlnp | grep :8000

# åœæ­¢å ç”¨ç«¯å£çš„è¿›ç¨‹
sudo kill -9 <PID>

# æˆ–ä¿®æ”¹é…ç½®æ–‡ä»¶ä¸­çš„ç«¯å£
nano .env
```

#### 8.1.3 æ¨¡å‹ä¸‹è½½å¤±è´¥

**é—®é¢˜**: Ollamaæ¨¡å‹ä¸‹è½½è¶…æ—¶æˆ–å¤±è´¥

**è§£å†³æ–¹æ¡ˆ**:
```bash
# æ‰‹åŠ¨ä¸‹è½½æ¨¡å‹
docker exec -it ollama ollama pull qwen3:30b

# æ£€æŸ¥æ¨¡å‹çŠ¶æ€
docker exec -it ollama ollama list

# å¦‚æœç½‘ç»œé—®é¢˜ï¼Œå¯ä»¥ä½¿ç”¨ä»£ç†
docker exec -it ollama sh -c "HTTP_PROXY=http://proxy:port ollama pull qwen3:30b"
```

### 8.2 è¿è¡Œæ—¶é—®é¢˜

#### 8.2.1 APIå“åº”æ…¢

**é—®é¢˜**: é—®ç­”æ¥å£å“åº”æ—¶é—´è¶…è¿‡10ç§’

**å¯èƒ½åŸå› **:
- å‘é‡æ•°æ®åº“æŸ¥è¯¢æ…¢
- å¤§è¯­è¨€æ¨¡å‹æ¨ç†æ…¢
- ç¼“å­˜æœªå‘½ä¸­

**è§£å†³æ–¹æ¡ˆ**:
```bash
# æ£€æŸ¥ç³»ç»Ÿèµ„æºä½¿ç”¨
docker stats

# æ£€æŸ¥Chromaæ•°æ®åº“çŠ¶æ€
curl http://localhost:8002/api/v1/heartbeat

# æ£€æŸ¥Ollamaæ¨¡å‹çŠ¶æ€
curl http://localhost:11434/api/tags

# æ£€æŸ¥Redisç¼“å­˜çŠ¶æ€
docker exec -it rag_redis_local redis-cli ping

# ä¼˜åŒ–é…ç½®
# 1. å‡å°‘æ£€ç´¢æ–‡æ¡£æ•°é‡
# 2. è°ƒæ•´ç›¸ä¼¼åº¦é˜ˆå€¼
# 3. å¯ç”¨ç¼“å­˜
```

#### 8.2.2 å†…å­˜ä½¿ç”¨è¿‡é«˜

**é—®é¢˜**: ç³»ç»Ÿå†…å­˜ä½¿ç”¨ç‡è¶…è¿‡90%

**è§£å†³æ–¹æ¡ˆ**:
```bash
# æ£€æŸ¥å„å®¹å™¨å†…å­˜ä½¿ç”¨
docker stats --format "table {{.Container}}\t{{.CPUPerc}}\t{{.MemUsage}}"

# é‡å¯å†…å­˜ä½¿ç”¨é«˜çš„å®¹å™¨
docker restart container_name

# è°ƒæ•´Dockerå†…å­˜é™åˆ¶
# åœ¨docker-compose.ymlä¸­æ·»åŠ :
# deploy:
#   resources:
#     limits:
#       memory: 4G
```

#### 8.2.3 æ–‡æ¡£å¤„ç†å¤±è´¥

**é—®é¢˜**: ä¸Šä¼ çš„æ–‡æ¡£æ— æ³•å¤„ç†

**è§£å†³æ–¹æ¡ˆ**:
```bash
# æ£€æŸ¥æ–‡ä»¶æ ¼å¼å’Œå¤§å°
ls -lh /app/data/uploads/

# æ£€æŸ¥æ–‡æ¡£å¤„ç†æ—¥å¿—
docker logs rag_fastapi_local

# æ‰‹åŠ¨æµ‹è¯•æ–‡æ¡£å¤„ç†
curl -X POST "http://localhost/api/documents/process" \
  -H "Content-Type: application/json" \
  -d '{"file_path": "/path/to/document.pdf"}'
```

### 8.3 æ€§èƒ½ä¼˜åŒ–é—®é¢˜

#### 8.3.1 æå‡é—®ç­”é€Ÿåº¦

**ä¼˜åŒ–ç­–ç•¥**:
1. **å¯ç”¨ç¼“å­˜**: ç¡®ä¿Redisç¼“å­˜æ­£å¸¸å·¥ä½œ
2. **è°ƒæ•´æ£€ç´¢å‚æ•°**: å‡å°‘kå€¼å’Œæé«˜ç›¸ä¼¼åº¦é˜ˆå€¼
3. **ä½¿ç”¨GPU**: ä¸ºåµŒå…¥æ¨¡å‹å¯ç”¨GPUåŠ é€Ÿ
4. **ä¼˜åŒ–æ¨¡å‹**: ä½¿ç”¨æ›´å°çš„è¯­è¨€æ¨¡å‹

**é…ç½®ç¤ºä¾‹**:
```bash
# .envæ–‡ä»¶ä¼˜åŒ–
RETRIEVAL_K=3
SIMILARITY_THRESHOLD=0.8
EMBEDDING_DEVICE=cuda
CACHE_TTL=7200
```

#### 8.3.2 æå‡å¹¶å‘èƒ½åŠ›

**ä¼˜åŒ–ç­–ç•¥**:
1. **å¢åŠ å·¥ä½œè¿›ç¨‹**: è°ƒæ•´FastAPI workeræ•°é‡
2. **ä¼˜åŒ–æ•°æ®åº“è¿æ¥**: å¢åŠ è¿æ¥æ± å¤§å°
3. **è´Ÿè½½å‡è¡¡**: éƒ¨ç½²å¤šä¸ªåº”ç”¨å®ä¾‹

**é…ç½®ç¤ºä¾‹**:
```yaml
# docker-compose.yml
fastapi-app:
  command: uvicorn src.main:app --host 0.0.0.0 --port 8000 --workers 4
```

### 8.4 æ•°æ®é—®é¢˜

#### 8.4.1 å‘é‡æ•°æ®ä¸¢å¤±

**é—®é¢˜**: é‡å¯åå‘é‡æ•°æ®æ¶ˆå¤±

**è§£å†³æ–¹æ¡ˆ**:
```bash
# æ£€æŸ¥æ•°æ®æŒä¹…åŒ–é…ç½®
docker volume ls | grep chroma

# ç¡®ä¿æ•°æ®ç›®å½•æŒ‚è½½æ­£ç¡®
# docker-compose.ymlä¸­åº”æœ‰:
# volumes:
#   - ./data/chroma:/chroma/chroma

# å¤‡ä»½å‘é‡æ•°æ®
docker exec rag_chroma_local tar -czf /tmp/chroma_backup.tar.gz /chroma
docker cp rag_chroma_local:/tmp/chroma_backup.tar.gz ./backup/
```

#### 8.4.2 ç¼“å­˜æ•°æ®å¼‚å¸¸

**é—®é¢˜**: ç¼“å­˜è¿”å›é”™è¯¯æ•°æ®

**è§£å†³æ–¹æ¡ˆ**:
```bash
# æ¸…é™¤æ‰€æœ‰ç¼“å­˜
curl -X DELETE "http://localhost/api/system/cache?pattern=*"

# æˆ–æ‰‹åŠ¨æ¸…é™¤Redis
docker exec -it rag_redis_local redis-cli FLUSHALL

# æ£€æŸ¥ç¼“å­˜é…ç½®
docker exec -it rag_redis_local redis-cli CONFIG GET "*"
```

### 8.5 ç½‘ç»œè¿æ¥é—®é¢˜

#### 8.5.1 æœåŠ¡é—´é€šä¿¡å¤±è´¥

**é—®é¢˜**: å®¹å™¨é—´æ— æ³•é€šä¿¡

**è§£å†³æ–¹æ¡ˆ**:
```bash
# æ£€æŸ¥Dockerç½‘ç»œ
docker network ls
docker network inspect rag_network_local

# æ£€æŸ¥å®¹å™¨ç½‘ç»œè¿æ¥
docker exec -it rag_fastapi_local ping rag_chroma_local
docker exec -it rag_fastapi_local ping rag_redis_local

# é‡å»ºç½‘ç»œ
docker-compose down
docker-compose up -d
```

#### 8.5.2 å¤–éƒ¨è®¿é—®å¤±è´¥

**é—®é¢˜**: æ— æ³•ä»å¤–éƒ¨è®¿é—®ç³»ç»Ÿ

**è§£å†³æ–¹æ¡ˆ**:
```bash
# æ£€æŸ¥ç«¯å£æ˜ å°„
docker port rag_nginx_local

# æ£€æŸ¥é˜²ç«å¢™è®¾ç½®
sudo ufw status
sudo ufw allow 80
sudo ufw allow 443

# æ£€æŸ¥Nginxé…ç½®
docker exec -it rag_nginx_local nginx -t
```

### 8.6 ç›‘æ§å‘Šè­¦é—®é¢˜

#### 8.6.1 Prometheusæ— æ³•æ”¶é›†æŒ‡æ ‡

**é—®é¢˜**: Grafanaæ˜¾ç¤ºæ— æ•°æ®

**è§£å†³æ–¹æ¡ˆ**:
```bash
# æ£€æŸ¥Prometheusé…ç½®
curl http://localhost:9090/api/v1/targets

# æ£€æŸ¥åº”ç”¨æŒ‡æ ‡ç«¯ç‚¹
curl http://localhost:8001/metrics

# é‡å¯Prometheus
docker restart rag_prometheus_local
```

#### 8.6.2 æ—¥å¿—æ–‡ä»¶è¿‡å¤§

**é—®é¢˜**: æ—¥å¿—æ–‡ä»¶å ç”¨å¤§é‡ç£ç›˜ç©ºé—´

**è§£å†³æ–¹æ¡ˆ**:
```bash
# é…ç½®æ—¥å¿—è½®è½¬
# åœ¨docker-compose.ymlä¸­æ·»åŠ :
# logging:
#   driver: "json-file"
#   options:
#     max-size: "10m"
#     max-file: "3"

# æ‰‹åŠ¨æ¸…ç†æ—¥å¿—
docker system prune -f
```

---

## 9. ç»´æŠ¤ä¸å‡çº§è¯´æ˜

### 9.1 æ—¥å¸¸ç»´æŠ¤

#### 9.1.1 ç³»ç»Ÿç›‘æ§æ£€æŸ¥

**æ¯æ—¥æ£€æŸ¥é¡¹ç›®**:
```bash
# æ£€æŸ¥ç³»ç»Ÿå¥åº·çŠ¶æ€
curl http://localhost/api/system/health

# æ£€æŸ¥ç£ç›˜ç©ºé—´
df -h

# æ£€æŸ¥å†…å­˜ä½¿ç”¨
free -h

# æ£€æŸ¥å®¹å™¨çŠ¶æ€
docker ps -a
```

**æ¯å‘¨æ£€æŸ¥é¡¹ç›®**:
```bash
# æ£€æŸ¥æ—¥å¿—æ–‡ä»¶å¤§å°
du -sh logs/

# æ£€æŸ¥æ•°æ®å¤‡ä»½
ls -la backup/

# æ£€æŸ¥ç³»ç»Ÿæ›´æ–°
sudo apt update && sudo apt list --upgradable
```

#### 9.1.2 æ•°æ®å¤‡ä»½

**è‡ªåŠ¨å¤‡ä»½è„šæœ¬**:
```bash
#!/bin/bash
# backup.sh

DATE=$(date +%Y%m%d_%H%M%S)
BACKUP_DIR="./backup/$DATE"

mkdir -p $BACKUP_DIR

# å¤‡ä»½å‘é‡æ•°æ®åº“
docker exec rag_chroma_local tar -czf /tmp/chroma_$DATE.tar.gz /chroma
docker cp rag_chroma_local:/tmp/chroma_$DATE.tar.gz $BACKUP_DIR/

# å¤‡ä»½Redisæ•°æ®
docker exec rag_redis_local redis-cli BGSAVE
docker cp rag_redis_local:/data/dump.rdb $BACKUP_DIR/redis_$DATE.rdb

# å¤‡ä»½é…ç½®æ–‡ä»¶
cp .env $BACKUP_DIR/
cp docker-compose.local.yml $BACKUP_DIR/

# å¤‡ä»½ä¸Šä¼ çš„æ–‡æ¡£
tar -czf $BACKUP_DIR/documents_$DATE.tar.gz data/uploads/

echo "å¤‡ä»½å®Œæˆ: $BACKUP_DIR"
```

#### 9.1.3 æ€§èƒ½ä¼˜åŒ–

**å®šæœŸä¼˜åŒ–ä»»åŠ¡**:
```bash
# æ¸…ç†Dockerç³»ç»Ÿ
docker system prune -f

# ä¼˜åŒ–å‘é‡æ•°æ®åº“
# (Chromaä¼šè‡ªåŠ¨ä¼˜åŒ–ï¼Œæ— éœ€æ‰‹åŠ¨æ“ä½œ)

# æ¸…ç†è¿‡æœŸç¼“å­˜
curl -X DELETE "http://localhost/api/system/cache?pattern=expired:*"

# é‡å¯æœåŠ¡é‡Šæ”¾å†…å­˜
docker-compose restart
```

### 9.2 ç‰ˆæœ¬å‡çº§

#### 9.2.1 å‡çº§å‡†å¤‡

**å‡çº§å‰æ£€æŸ¥**:
```bash
# 1. å¤‡ä»½æ•°æ®
./scripts/backup.sh

# 2. è®°å½•å½“å‰ç‰ˆæœ¬
docker images | grep rag

# 3. æ£€æŸ¥å‡çº§è¯´æ˜
cat CHANGELOG.md

# 4. æµ‹è¯•ç¯å¢ƒéªŒè¯
# åœ¨æµ‹è¯•ç¯å¢ƒå…ˆè¿›è¡Œå‡çº§æµ‹è¯•
```

#### 9.2.2 åº”ç”¨å‡çº§

**å‡çº§æ­¥éª¤**:
```bash
# 1. åœæ­¢æœåŠ¡
docker-compose down

# 2. æ‹‰å–æ–°ç‰ˆæœ¬
git pull origin main

# 3. æ›´æ–°é•œåƒ
docker-compose pull

# 4. å¯åŠ¨æœåŠ¡
docker-compose up -d

# 5. éªŒè¯å‡çº§
curl http://localhost/api/system/version
```

#### 9.2.3 å›æ»šæ“ä½œ

**å¦‚æœå‡çº§å¤±è´¥**:
```bash
# 1. åœæ­¢æœåŠ¡
docker-compose down

# 2. æ¢å¤ä»£ç ç‰ˆæœ¬
git checkout <previous_version>

# 3. æ¢å¤æ•°æ®
./scripts/restore.sh backup/20231201_120000/

# 4. å¯åŠ¨æœåŠ¡
docker-compose up -d
```

### 9.3 æ•…éšœæ¢å¤

#### 9.3.1 æœåŠ¡æ•…éšœæ¢å¤

**è‡ªåŠ¨æ¢å¤è„šæœ¬**:
```bash
#!/bin/bash
# recovery.sh

# æ£€æŸ¥æœåŠ¡çŠ¶æ€
check_service() {
    local service=$1
    local url=$2
    
    if ! curl -f -s $url > /dev/null; then
        echo "æœåŠ¡ $service å¼‚å¸¸ï¼Œæ­£åœ¨é‡å¯..."
        docker restart $service
        sleep 30
        
        if curl -f -s $url > /dev/null; then
            echo "æœåŠ¡ $service æ¢å¤æ­£å¸¸"
        else
            echo "æœåŠ¡ $service é‡å¯å¤±è´¥ï¼Œéœ€è¦äººå·¥ä»‹å…¥"
            exit 1
        fi
    fi
}

# æ£€æŸ¥å„ä¸ªæœåŠ¡
check_service "rag_nginx_local" "http://localhost/health"
check_service "rag_fastapi_local" "http://localhost:8000/api/health"
check_service "rag_chroma_local" "http://localhost:8002/api/v1/heartbeat"
check_service "rag_redis_local" "http://localhost:6379"

echo "æ‰€æœ‰æœåŠ¡è¿è¡Œæ­£å¸¸"
```

#### 9.3.2 æ•°æ®æ¢å¤

**æ•°æ®æ¢å¤æ­¥éª¤**:
```bash
# 1. åœæ­¢ç›¸å…³æœåŠ¡
docker-compose stop chroma redis

# 2. æ¢å¤å‘é‡æ•°æ®åº“
docker cp backup/chroma_backup.tar.gz rag_chroma_local:/tmp/
docker exec rag_chroma_local tar -xzf /tmp/chroma_backup.tar.gz -C /

# 3. æ¢å¤Redisæ•°æ®
docker cp backup/redis_backup.rdb rag_redis_local:/data/dump.rdb

# 4. é‡å¯æœåŠ¡
docker-compose start chroma redis

# 5. éªŒè¯æ•°æ®
curl http://localhost/api/system/stats
```

### 9.4 å®‰å…¨ç»´æŠ¤

#### 9.4.1 å®‰å…¨æ›´æ–°

**å®šæœŸå®‰å…¨æ£€æŸ¥**:
```bash
# æ›´æ–°ç³»ç»Ÿå®‰å…¨è¡¥ä¸
sudo apt update && sudo apt upgrade -y

# æ›´æ–°Dockeré•œåƒ
docker-compose pull

# æ£€æŸ¥å®¹å™¨å®‰å…¨
docker scan rag_fastapi_local

# æ›´æ–°SSLè¯ä¹¦
sudo certbot renew
```

#### 9.4.2 è®¿é—®æ§åˆ¶

**å®šæœŸå®¡æŸ¥**:
```bash
# æ£€æŸ¥APIè®¿é—®æ—¥å¿—
tail -f logs/nginx/access.log | grep -E "(POST|PUT|DELETE)"

# æ£€æŸ¥å¼‚å¸¸è®¿é—®
grep -E "(40[0-9]|50[0-9])" logs/nginx/access.log

# æ›´æ–°APIå¯†é’¥
# 1. ç”Ÿæˆæ–°å¯†é’¥
# 2. æ›´æ–°.envæ–‡ä»¶
# 3. é‡å¯æœåŠ¡
# 4. é€šçŸ¥ç”¨æˆ·æ›´æ–°
```

---

## 10. æ€§èƒ½ä¼˜åŒ–å»ºè®®

### 10.1 ç¡¬ä»¶ä¼˜åŒ–

#### 10.1.1 CPUä¼˜åŒ–
- **é€‰æ‹©æ”¯æŒAVX2æŒ‡ä»¤é›†çš„CPU**: æå‡å‘é‡è®¡ç®—æ€§èƒ½
- **å¤šæ ¸å¿ƒé…ç½®**: æ¨è8æ ¸å¿ƒä»¥ä¸Šï¼Œæ”¯æŒå¹¶å‘å¤„ç†
- **é«˜é¢‘ç‡**: 3.0GHzä»¥ä¸Šä¸»é¢‘ï¼Œæå‡å•çº¿ç¨‹æ€§èƒ½

#### 10.1.2 å†…å­˜ä¼˜åŒ–
- **å¤§å®¹é‡å†…å­˜**: æ¨è32GBä»¥ä¸Šï¼Œæ”¯æŒå¤§æ¨¡å‹åŠ è½½
- **é«˜é€Ÿå†…å­˜**: DDR4-3200æˆ–æ›´é«˜ï¼Œå‡å°‘å†…å­˜è®¿é—®å»¶è¿Ÿ
- **å†…å­˜é€šé“**: åŒé€šé“æˆ–å››é€šé“é…ç½®

#### 10.1.3 å­˜å‚¨ä¼˜åŒ–
- **NVMe SSD**: ä½¿ç”¨NVMeæ¥å£çš„SSDï¼Œæå‡I/Oæ€§èƒ½
- **RAIDé…ç½®**: RAID 1æˆ–RAID 10ï¼Œå¹³è¡¡æ€§èƒ½å’Œå¯é æ€§
- **åˆ†ç¦»å­˜å‚¨**: ç³»ç»Ÿã€æ•°æ®ã€æ—¥å¿—ä½¿ç”¨ä¸åŒç£ç›˜

#### 10.1.4 GPUåŠ é€Ÿ
- **NVIDIA GPU**: RTX 4090æˆ–A100ï¼Œæ”¯æŒCUDAåŠ é€Ÿ
- **æ˜¾å­˜å®¹é‡**: 24GBä»¥ä¸Šæ˜¾å­˜ï¼Œæ”¯æŒå¤§æ¨¡å‹æ¨ç†
- **å¤šGPU**: æ”¯æŒå¤šGPUå¹¶è¡Œå¤„ç†

### 10.2 è½¯ä»¶ä¼˜åŒ–

#### 10.2.1 åº”ç”¨å±‚ä¼˜åŒ–

**FastAPIé…ç½®ä¼˜åŒ–**:
```python
# å¢åŠ å·¥ä½œè¿›ç¨‹æ•°
uvicorn src.main:app --workers 4 --worker-class uvicorn.workers.UvicornWorker

# å¯ç”¨å¼‚æ­¥å¤„ç†
async def process_request():
    # ä½¿ç”¨å¼‚æ­¥æ“ä½œ
    pass

# è¿æ¥æ± ä¼˜åŒ–
CHROMA_CLIENT_POOL_SIZE = 20
REDIS_CONNECTION_POOL_SIZE = 50
```

**RAGå¼•æ“ä¼˜åŒ–**:
```python
# æ‰¹é‡å¤„ç†ä¼˜åŒ–
async def batch_process_documents(documents, batch_size=10):
    for i in range(0, len(documents), batch_size):
        batch = documents[i:i+batch_size]
        await process_batch(batch)

# ç¼“å­˜ç­–ç•¥ä¼˜åŒ–
CACHE_TTL = 3600  # 1å°æ—¶ç¼“å­˜
CACHE_MAX_SIZE = 1000  # æœ€å¤§ç¼“å­˜æ¡ç›®æ•°
```

#### 10.2.2 æ•°æ®åº“ä¼˜åŒ–

**Chromaå‘é‡æ•°æ®åº“ä¼˜åŒ–**:
```python
# ç´¢å¼•ä¼˜åŒ–
collection.create_index(
    index_type="HNSW",
    metric="cosine",
    params={"M": 16, "efConstruction": 200}
)

# æ‰¹é‡æ’å…¥ä¼˜åŒ–
collection.add(
    documents=documents,
    embeddings=embeddings,
    metadatas=metadatas,
    ids=ids,
    batch_size=100
)
```

**Redisç¼“å­˜ä¼˜åŒ–**:
```bash
# redis.confä¼˜åŒ–
maxmemory 8gb
maxmemory-policy allkeys-lru
save 900 1
save 300 10
save 60 10000
```

#### 10.2.3 æ¨¡å‹ä¼˜åŒ–

**åµŒå…¥æ¨¡å‹ä¼˜åŒ–**:
```python
# æ¨¡å‹é‡åŒ–
model = SentenceTransformer('BAAI/bge-large-zh-v1.5')
model.half()  # ä½¿ç”¨åŠç²¾åº¦æµ®ç‚¹æ•°

# æ‰¹é‡ç¼–ç 
embeddings = model.encode(
    texts, 
    batch_size=32,
    show_progress_bar=False,
    convert_to_numpy=True
)
```

**å¤§è¯­è¨€æ¨¡å‹ä¼˜åŒ–**:
```bash
# Ollamaé…ç½®ä¼˜åŒ–
OLLAMA_NUM_PARALLEL=4
OLLAMA_MAX_LOADED_MODELS=2
OLLAMA_FLASH_ATTENTION=1
```

### 10.3 ç³»ç»Ÿä¼˜åŒ–

#### 10.3.1 æ“ä½œç³»ç»Ÿä¼˜åŒ–

**Linuxå†…æ ¸å‚æ•°ä¼˜åŒ–**:
```bash
# /etc/sysctl.conf
vm.swappiness=10
vm.dirty_ratio=15
vm.dirty_background_ratio=5
net.core.somaxconn=65535
net.ipv4.tcp_max_syn_backlog=65535
```

**æ–‡ä»¶ç³»ç»Ÿä¼˜åŒ–**:
```bash
# ä½¿ç”¨XFSæ–‡ä»¶ç³»ç»Ÿ
mkfs.xfs /dev/sdb1

# æŒ‚è½½ä¼˜åŒ–
mount -o noatime,nodiratime /dev/sdb1 /data
```

#### 10.3.2 Dockerä¼˜åŒ–

**Dockeré…ç½®ä¼˜åŒ–**:
```json
{
  "storage-driver": "overlay2",
  "log-driver": "json-file",
  "log-opts": {
    "max-size": "10m",
    "max-file": "3"
  },
  "default-ulimits": {
    "nofile": {
      "Name": "nofile",
      "Hard": 65536,
      "Soft": 65536
    }
  }
}
```

**å®¹å™¨èµ„æºé™åˆ¶**:
```yaml
# docker-compose.yml
services:
  fastapi-app:
    deploy:
      resources:
        limits:
          cpus: '4.0'
          memory: 8G
        reservations:
          cpus: '2.0'
          memory: 4G
```

#### 10.3.3 ç½‘ç»œä¼˜åŒ–

**Nginxé…ç½®ä¼˜åŒ–**:
```nginx
# nginx.conf
worker_processes auto;
worker_connections 4096;
keepalive_timeout 65;
keepalive_requests 1000;

# å¯ç”¨HTTP/2
listen 443 ssl http2;

# å¯ç”¨å‹ç¼©
gzip on;
gzip_comp_level 6;
gzip_types text/plain text/css application/json application/javascript;

# ç¼“å­˜é…ç½®
proxy_cache_path /var/cache/nginx levels=1:2 keys_zone=api_cache:10m max_size=1g;
```

### 10.4 ç›‘æ§ä¼˜åŒ–

#### 10.4.1 æŒ‡æ ‡æ”¶é›†ä¼˜åŒ–

**Prometheusé…ç½®ä¼˜åŒ–**:
```yaml
# prometheus.yml
global:
  scrape_interval: 15s
  evaluation_interval: 15s

scrape_configs:
  - job_name: 'rag-system'
    scrape_interval: 5s
    static_configs:
      - targets: ['fastapi-app:8001']
```

**è‡ªå®šä¹‰æŒ‡æ ‡**:
```python
# æ·»åŠ ä¸šåŠ¡æŒ‡æ ‡
from prometheus_client import Counter, Histogram, Gauge

REQUEST_COUNT = Counter('rag_requests_total', 'Total requests', ['endpoint', 'method'])
REQUEST_DURATION = Histogram('rag_request_duration_seconds', 'Request duration')
ACTIVE_USERS = Gauge('rag_active_users', 'Active users')
```

#### 10.4.2 æ—¥å¿—ä¼˜åŒ–

**ç»“æ„åŒ–æ—¥å¿—**:
```python
import structlog

logger = structlog.get_logger()
logger.info("Processing document", 
           document_id="doc123", 
           file_size=1024000,
           processing_time=2.5)
```

**æ—¥å¿—è½®è½¬é…ç½®**:
```yaml
# docker-compose.yml
logging:
  driver: "json-file"
  options:
    max-size: "100m"
    max-file: "5"
```

### 10.5 æ€§èƒ½æµ‹è¯•

#### 10.5.1 è´Ÿè½½æµ‹è¯•

**ä½¿ç”¨Locustè¿›è¡Œè´Ÿè½½æµ‹è¯•**:
```python
# locustfile.py
from locust import HttpUser, task, between

class RAGUser(HttpUser):
    wait_time = between(1, 3)
    
    @task(3)
    def ask_question(self):
        self.client.post("/api/qa/ask", json={
            "question": "ä»€ä¹ˆæ˜¯äººå·¥æ™ºèƒ½ï¼Ÿ",
            "k": 5
        })
    
    @task(1)
    def upload_document(self):
        with open("test.pdf", "rb") as f:
            self.client.post("/api/documents/upload", 
                           files={"file": f})
```

**è¿è¡Œè´Ÿè½½æµ‹è¯•**:
```bash
# å¯åŠ¨è´Ÿè½½æµ‹è¯•
locust -f locustfile.py --host=http://localhost -u 100 -r 10 -t 300s

# ç›‘æ§ç³»ç»Ÿèµ„æº
htop
iotop
nethogs
```

#### 10.5.2 æ€§èƒ½åŸºå‡†æµ‹è¯•

**APIå“åº”æ—¶é—´æµ‹è¯•**:
```bash
# ä½¿ç”¨abè¿›è¡ŒåŸºå‡†æµ‹è¯•
ab -n 1000 -c 10 -p question.json -T application/json http://localhost/api/qa/ask

# ä½¿ç”¨wrkè¿›è¡Œæµ‹è¯•
wrk -t12 -c400 -d30s --script=post.lua http://localhost/api/qa/ask
```

**æ•°æ®åº“æ€§èƒ½æµ‹è¯•**:
```python
# å‘é‡æ£€ç´¢æ€§èƒ½æµ‹è¯•
import time
import numpy as np

def benchmark_vector_search():
    query_vector = np.random.rand(1024).tolist()
    
    start_time = time.time()
    results = collection.query(
        query_embeddings=[query_vector],
        n_results=10
    )
    end_time = time.time()
    
    print(f"æ£€ç´¢æ—¶é—´: {end_time - start_time:.3f}ç§’")
```

é€šè¿‡ä»¥ä¸Šä¼˜åŒ–æªæ–½ï¼Œå¯ä»¥æ˜¾è‘—æå‡RAGç³»ç»Ÿçš„æ€§èƒ½è¡¨ç°ï¼Œæ»¡è¶³ç”Ÿäº§ç¯å¢ƒçš„é«˜å¹¶å‘å’Œä½å»¶è¿Ÿè¦æ±‚ã€‚å»ºè®®æ ¹æ®å®é™…ä½¿ç”¨åœºæ™¯å’Œèµ„æºæƒ…å†µï¼Œé€‰æ‹©åˆé€‚çš„ä¼˜åŒ–ç­–ç•¥è¿›è¡Œå®æ–½ã€‚

**æ“ä½œç³»ç»Ÿ**:
- Ubuntu 20.04+ / CentOS 8+ / RHEL 8+
- macOS 12+ (å¼€å‘ç¯å¢ƒ)
- Windows 10+ (å¼€å‘ç¯å¢ƒ)

**å®¹å™¨ç¯å¢ƒ**:
- Docker 20.10+
- Docker Compose 2.0+

**Pythonç¯å¢ƒ**:
- Python 3.9+
- pip 21.0+

### 4.2 æ€§èƒ½å‚æ•°

#### 4.2.1 å¤„ç†èƒ½åŠ›

| æŒ‡æ ‡ | æ•°å€¼ | è¯´æ˜ |
|------|------|------|
| å¹¶å‘ç”¨æˆ·æ•° | 1000+ | åŒæ—¶åœ¨çº¿ç”¨æˆ·æ•° |
| QPS | 100+ | æ¯ç§’æŸ¥è¯¢æ•° |
| å“åº”æ—¶é—´ | <3ç§’ | å¹³å‡é—®ç­”å“åº”æ—¶é—´ |
| æ–‡æ¡£å¤„ç†é€Ÿåº¦ | 10MB/åˆ†é’Ÿ | æ–‡æ¡£å‘é‡åŒ–é€Ÿåº¦ |
| å­˜å‚¨å®¹é‡ | 100GB+ | æ”¯æŒçš„æ–‡æ¡£å­˜å‚¨é‡ |

#### 4.2.2 å¯ç”¨æ€§æŒ‡æ ‡

| æŒ‡æ ‡ | ç›®æ ‡å€¼ | è¯´æ˜ |
|------|--------|------|
| ç³»ç»Ÿå¯ç”¨æ€§ | 99.9% | å¹´åº¦å¯ç”¨æ—¶é—´ |
| æ•…éšœæ¢å¤æ—¶é—´ | <5åˆ†é’Ÿ | å¹³å‡æ•…éšœæ¢å¤æ—¶é—´ |
| æ•°æ®å¤‡ä»½é¢‘ç‡ | æ¯æ—¥ | è‡ªåŠ¨æ•°æ®å¤‡ä»½ |
| ç›‘æ§è¦†ç›–ç‡ | 100% | å…³é”®ç»„ä»¶ç›‘æ§è¦†ç›– |

### 4.3 æŠ€æœ¯æ ˆ

#### 4.3.1 åç«¯æŠ€æœ¯

| ç»„ä»¶ | æŠ€æœ¯ | ç‰ˆæœ¬ | è¯´æ˜ |
|------|------|------|------|
| Webæ¡†æ¶ | FastAPI | 0.104+ | é«˜æ€§èƒ½å¼‚æ­¥Webæ¡†æ¶ |
| è¯­è¨€æ¨¡å‹ | Qwen3 | 30B | å¤§è¯­è¨€æ¨¡å‹ |
| åµŒå…¥æ¨¡å‹ | BGE-Large-ZH | v1.5 | ä¸­æ–‡åµŒå…¥æ¨¡å‹ |
| å‘é‡æ•°æ®åº“ | Chroma | 0.4+ | å‘é‡å­˜å‚¨å’Œæ£€ç´¢ |
| ç¼“å­˜ | Redis | 7.2+ | å†…å­˜æ•°æ®åº“ |
| è´Ÿè½½å‡è¡¡ | Nginx | 1.25+ | åå‘ä»£ç†æœåŠ¡å™¨ |

#### 4.3.2 AI/MLæŠ€æœ¯

| ç»„ä»¶ | æŠ€æœ¯ | è¯´æ˜ |
|------|------|------|
| æ–‡æ¡£è§£æ | LangChain | æ–‡æ¡£åŠ è½½å’Œå¤„ç† |
| æ–‡æœ¬åˆ†å‰² | RecursiveCharacterTextSplitter | æ™ºèƒ½æ–‡æœ¬åˆ†å— |
| å‘é‡æ£€ç´¢ | Cosine Similarity | ä½™å¼¦ç›¸ä¼¼åº¦æ£€ç´¢ |
| æ¨¡å‹æ¨ç† | Ollama | æœ¬åœ°æ¨¡å‹æ¨ç†æœåŠ¡ |

#### 4.3.3 ç›‘æ§è¿ç»´

| ç»„ä»¶ | æŠ€æœ¯ | è¯´æ˜ |
|------|------|------|
| æŒ‡æ ‡æ”¶é›† | Prometheus | ç³»ç»ŸæŒ‡æ ‡ç›‘æ§ |
| å¯è§†åŒ– | Grafana | ç›‘æ§ä»ªè¡¨æ¿ |
| æ—¥å¿—ç®¡ç† | Loguru | ç»“æ„åŒ–æ—¥å¿— |
| å®¹å™¨åŒ– | Docker | åº”ç”¨å®¹å™¨åŒ– |

### 4.4 ç½‘ç»œè¦æ±‚

#### 4.4.1 ç«¯å£é…ç½®

| æœåŠ¡ | ç«¯å£ | åè®® | è¯´æ˜ |
|------|------|------|------|
| Nginx | 80 | HTTP | WebæœåŠ¡ |
| Nginx | 443 | HTTPS | å®‰å…¨WebæœåŠ¡ |
| FastAPI | 8000 | HTTP | APIæœåŠ¡ |
| FastAPI Metrics | 8001 | HTTP | ç›‘æ§æŒ‡æ ‡ |
| Chroma | 8002 | HTTP | å‘é‡æ•°æ®åº“ |
| Redis | 6379 | TCP | ç¼“å­˜æœåŠ¡ |
| Ollama | 11434 | HTTP | æ¨¡å‹æ¨ç†æœåŠ¡ |
| Prometheus | 9090 | HTTP | ç›‘æ§æœåŠ¡ |
| Grafana | 3000 | HTTP | å¯è§†åŒ–æœåŠ¡ |

#### 4.4.2 å®‰å…¨é…ç½®

| é…ç½®é¡¹ | å»ºè®®å€¼ | è¯´æ˜ |
|--------|--------|------|
| é˜²ç«å¢™ | å¯ç”¨ | åªå¼€æ”¾å¿…è¦ç«¯å£ |
| SSL/TLS | TLS 1.2+ | åŠ å¯†ä¼ è¾“ |
| APIè®¤è¯ | å¯ç”¨ | APIå¯†é’¥è®¤è¯ |
| è®¿é—®æ—¥å¿— | å¯ç”¨ | è®°å½•è®¿é—®æ—¥å¿— |
| é€Ÿç‡é™åˆ¶ | 100/åˆ†é’Ÿ | é˜²æ­¢æ»¥ç”¨ |

---

## 5. å®‰è£…éƒ¨ç½²æŒ‡å—

### 5.1 ç¯å¢ƒå‡†å¤‡

#### 5.1.1 ç³»ç»Ÿç¯å¢ƒæ£€æŸ¥

```bash
# æ£€æŸ¥æ“ä½œç³»ç»Ÿç‰ˆæœ¬
cat /etc/os-release

# æ£€æŸ¥CPUä¿¡æ¯
lscpu

# æ£€æŸ¥å†…å­˜ä¿¡æ¯
free -h

# æ£€æŸ¥ç£ç›˜ç©ºé—´
df -h

# æ£€æŸ¥ç½‘ç»œè¿æ¥
ping -c 4 google.com
```

#### 5.1.2 å®‰è£…Docker

**Ubuntu/Debian**:
```bash
# æ›´æ–°åŒ…ç´¢å¼•
sudo apt update

# å®‰è£…ä¾èµ–
sudo apt install -y apt-transport-https ca-certificates curl gnupg lsb-release

# æ·»åŠ Dockerå®˜æ–¹GPGå¯†é’¥
curl -fsSL https://download.docker.com/linux/ubuntu/gpg | sudo gpg --dearmor -o /usr/share/keyrings/docker-archive-keyring.gpg

# æ·»åŠ Dockerä»“åº“
echo "deb [arch=amd64 signed-by=/usr/share/keyrings/docker-archive-keyring.gpg] https://download.docker.com/linux/ubuntu $(lsb_release -cs) stable" | sudo tee /etc/apt/sources.list.d/docker.list > /dev/null

# å®‰è£…Docker
sudo apt update
sudo apt install -y docker-ce docker-ce-cli containerd.io docker-compose-plugin

# å¯åŠ¨DockeræœåŠ¡
sudo systemctl start docker
sudo systemctl enable docker

# æ·»åŠ ç”¨æˆ·åˆ°dockerç»„
sudo usermod -aG docker $USER
```

**CentOS/RHEL**:
```bash
# å®‰è£…ä¾èµ–
sudo yum install -y yum-utils

# æ·»åŠ Dockerä»“åº“
sudo yum-config-manager --add-repo https://download.docker.com/linux/centos/docker-ce.repo

# å®‰è£…Docker
sudo yum install -y docker-ce docker-ce-cli containerd.io docker-compose-plugin

# å¯åŠ¨DockeræœåŠ¡
sudo systemctl start docker
sudo systemctl enable docker

# æ·»åŠ ç”¨æˆ·åˆ°dockerç»„
sudo usermod -aG docker $USER
```

#### 5.1.3 éªŒè¯å®‰è£…

```bash
# éªŒè¯Dockerå®‰è£…
docker --version
docker compose version

# æµ‹è¯•Dockerè¿è¡Œ
docker run hello-world
```

### 5.2 è·å–æºç 

#### 5.2.1 å…‹éš†ä»“åº“

```bash
# å…‹éš†é¡¹ç›®ä»“åº“
git clone https://github.com/your-org/rag-system.git
cd rag-system

# æ£€æŸ¥é¡¹ç›®ç»“æ„
ls -la
```

#### 5.2.2 é…ç½®ç¯å¢ƒå˜é‡

```bash
# å¤åˆ¶ç¯å¢ƒå˜é‡æ¨¡æ¿
cp .env.example .env

# ç¼–è¾‘ç¯å¢ƒå˜é‡
nano .env
```

**ç¯å¢ƒå˜é‡é…ç½®ç¤ºä¾‹**:
```bash
# åº”ç”¨é…ç½®
APP_NAME=RAGçŸ¥è¯†åº“é—®ç­”ç³»ç»Ÿ
APP_VERSION=2.0.0
DEBUG=false
HOST=0.0.0.0
PORT=8000

# Ollamaé…ç½®
OLLAMA_BASE_URL=http://localhost:11434
OLLAMA_MODEL=qwen3:30b
OLLAMA_TIMEOUT=300

# Chromaé…ç½®
CHROMA_HOST=localhost
CHROMA_PORT=8002
CHROMA_COLLECTION=rag_documents

# Redisé…ç½®
REDIS_HOST=localhost
REDIS_PORT=6379
REDIS_DB=0
CACHE_TTL=3600

# æ–‡æ¡£å¤„ç†é…ç½®
MAX_FILE_SIZE=52428800
CHUNK_SIZE=1000
CHUNK_OVERLAP=200
RETRIEVAL_K=5
SIMILARITY_THRESHOLD=0.7

# æ¨¡å‹é…ç½®
EMBEDDING_MODEL=BAAI/bge-large-zh-v1.5
EMBEDDING_DEVICE=cuda
MAX_TOKENS=2000
TEMPERATURE=0.7

# å®‰å…¨é…ç½®
API_KEY=your-secret-api-key
CORS_ORIGINS=["*"]

# ç›‘æ§é…ç½®
ENABLE_METRICS=true
METRICS_PORT=8001
LOG_LEVEL=INFO
```

### 5.3 éƒ¨ç½²æ–¹å¼

#### 5.3.1 æœ¬åœ°å¼€å‘éƒ¨ç½²

```bash
# å®‰è£…Pythonä¾èµ–
pip install -r requirements.txt

# å¯åŠ¨ä¾èµ–æœåŠ¡
docker compose -f docker-compose.local.yml up -d chroma redis

# å¯åŠ¨OllamaæœåŠ¡ (å¦‚æœæœªè¿è¡Œ)
docker run -d -v ollama:/root/.ollama -p 11434:11434 --name ollama ollama/ollama

# ä¸‹è½½æ¨¡å‹
docker exec -it ollama ollama pull qwen3:30b

# å¯åŠ¨åº”ç”¨
python -m uvicorn src.main:app --host 0.0.0.0 --port 8000 --reload
```

#### 5.3.2 Docker Composeéƒ¨ç½²

```bash
# æ„å»ºå¹¶å¯åŠ¨æ‰€æœ‰æœåŠ¡
docker compose up -d

# æŸ¥çœ‹æœåŠ¡çŠ¶æ€
docker compose ps

# æŸ¥çœ‹æ—¥å¿—
docker compose logs -f
```

#### 5.3.3 ç”Ÿäº§ç¯å¢ƒéƒ¨ç½²

```bash
# ä½¿ç”¨ç”Ÿäº§é…ç½®
cp .env.production .env

# å¯åŠ¨ç”Ÿäº§æœåŠ¡
docker compose -f docker-compose.yml up -d

# é…ç½®Nginx (å¦‚æœä½¿ç”¨å¤–éƒ¨Nginx)
sudo cp nginx/nginx.conf /etc/nginx/sites-available/rag-system
sudo ln -s /etc/nginx/sites-available/rag-system /etc/nginx/sites-enabled/
sudo nginx -t
sudo systemctl reload nginx
```

### 5.4 éƒ¨ç½²éªŒè¯

#### 5.4.1 æœåŠ¡å¥åº·æ£€æŸ¥

```bash
# æ£€æŸ¥æ‰€æœ‰å®¹å™¨çŠ¶æ€
docker compose ps

# æ£€æŸ¥åº”ç”¨å¥åº·çŠ¶æ€
curl http://localhost/api/health

# æ£€æŸ¥ç³»ç»Ÿç»Ÿè®¡
curl http://localhost/api/system/stats
```

#### 5.4.2 åŠŸèƒ½æµ‹è¯•

```bash
# æµ‹è¯•æ–‡æ¡£ä¸Šä¼ 
curl -X POST "http://localhost/api/documents/upload" \
  -H "Content-Type: multipart/form-data" \
  -F "file=@test.txt"

# æµ‹è¯•é—®ç­”åŠŸèƒ½
curl -X POST "http://localhost/api/qa/ask" \
  -H "Content-Type: application/json" \
  -d '{"question": "æµ‹è¯•é—®é¢˜"}'
```

#### 5.4.3 æ€§èƒ½æµ‹è¯•

```bash
# å®‰è£…æµ‹è¯•å·¥å…·
pip install locust

# è¿è¡Œæ€§èƒ½æµ‹è¯•
locust -f tests/performance/locustfile.py --host=http://localhost
```

### 5.5 SSLé…ç½® (å¯é€‰)

#### 5.5.1 ç”ŸæˆSSLè¯ä¹¦

```bash
# ä½¿ç”¨Let's Encrypt
sudo apt install certbot python3-certbot-nginx
sudo certbot --nginx -d your-domain.com

# æˆ–ä½¿ç”¨è‡ªç­¾åè¯ä¹¦ (æµ‹è¯•ç¯å¢ƒ)
sudo openssl req -x509 -nodes -days 365 -newkey rsa:2048 \
  -keyout /etc/ssl/private/rag-system.key \
  -out /etc/ssl/certs/rag-system.crt
```

#### 5.5.2 é…ç½®HTTPS

```bash
# æ›´æ–°Nginxé…ç½®
sudo nano /etc/nginx/sites-available/rag-system

# é‡æ–°åŠ è½½Nginx
sudo nginx -t
sudo systemctl reload nginx
```

---

## 6. ä½¿ç”¨æ“ä½œæŒ‡å—

### 6.1 ç³»ç»Ÿè®¿é—®

#### 6.1.1 Webç•Œé¢è®¿é—®

1. **æ‰“å¼€æµè§ˆå™¨**ï¼Œè®¿é—®ç³»ç»Ÿåœ°å€ï¼š
   - æœ¬åœ°éƒ¨ç½²: `http://localhost`
   - ç”Ÿäº§ç¯å¢ƒ: `https://your-domain.com`

2. **APIæ–‡æ¡£è®¿é—®**:
   - Swagger UI: `http://localhost/docs`
   - ReDoc: `http://localhost/redoc`

3. **ç›‘æ§ç•Œé¢è®¿é—®**:
   - Grafana: `http://localhost:3000`
   - Prometheus: `http://localhost:9090`

#### 6.1.2 APIè®¤è¯

å¦‚æœå¯ç”¨äº†APIè®¤è¯ï¼Œéœ€è¦åœ¨è¯·æ±‚å¤´ä¸­åŒ…å«APIå¯†é’¥ï¼š

```bash
# ä½¿ç”¨Authorizationå¤´
curl -H "Authorization: Bearer your-api-key" \
  http://localhost/api/system/stats

# ä½¿ç”¨X-API-Keyå¤´
curl -H "X-API-Key: your-api-key" \
  http://localhost/api/system/stats
```

### 6.2 æ–‡æ¡£ç®¡ç†æ“ä½œ

#### 6.2.1 ä¸Šä¼ æ–‡æ¡£

**å•æ–‡ä»¶ä¸Šä¼ **:
```bash
curl -X POST "http://localhost/api/documents/upload" \
  -H "Content-Type: multipart/form-data" \
  -F "file=@document.pdf"
```

**æ‰¹é‡ä¸Šä¼ **:
```bash
curl -X POST "http://localhost/api/documents/batch-upload" \
  -H "Content-Type: multipart/form-data" \
  -F "files=@doc1.pdf" \
  -F "files=@doc2.txt" \
  -F "files=@doc3.md"
```

**å“åº”ç¤ºä¾‹**:
```json
{
  "success": true,
  "message": "æ–‡ä»¶ä¸Šä¼ æˆåŠŸ",
  "filename": "document.pdf",
  "file_path": "/app/data/uploads/document_20231201_123456.pdf",
  "file_size": 1048576,
  "upload_time": "2023-12-01T12:34:56"
}
```

#### 6.2.2 å¤„ç†æ–‡æ¡£

**å¤„ç†å•ä¸ªæ–‡æ¡£**:
```bash
curl -X POST "http://localhost/api/documents/process" \
  -H "Content-Type: application/json" \
  -d '{
    "file_path": "/app/data/uploads/document.pdf",
    "chunk_size": 1000,
    "chunk_overlap": 200
  }'
```

**å¤„ç†ç›®å½•**:
```bash
curl -X POST "http://localhost/api/documents/process-directory" \
  -H "Content-Type: application/json" \
  -d '{
    "directory_path": "/app/data/uploads/",
    "recursive": true
  }'
```

**å“åº”ç¤ºä¾‹**:
```json
{
  "success": true,
  "message": "æ–‡æ¡£å¤„ç†å®Œæˆ",
  "file_path": "/app/data/uploads/document.pdf",
  "original_docs": 1,
  "chunks_created": 15,
  "stored_count": 15,
  "processing_time": 12.5,
  "skipped_count": 0
}
```

#### 6.2.3 ç®¡ç†æ–‡æ¡£

**æŸ¥çœ‹æ–‡æ¡£åˆ—è¡¨**:
```bash
curl "http://localhost/api/documents/list?limit=10&offset=0"
```

**åˆ é™¤æ–‡æ¡£**:
```bash
curl -X DELETE "http://localhost/api/documents/delete" \
  -H "Content-Type: application/json" \
  -d '{
    "file_path": "/app/data/uploads/document.pdf"
  }'
```

**è·å–æ–‡æ¡£ç»Ÿè®¡**:
```bash
curl "http://localhost/api/documents/stats"
```

### 6.3 é—®ç­”æ“ä½œ

#### 6.3.1 å•é—®é¢˜é—®ç­”

**åŸºç¡€é—®ç­”**:
```bash
curl -X POST "http://localhost/api/qa/ask" \
  -H "Content-Type: application/json" \
  -d '{
    "question": "ä»€ä¹ˆæ˜¯äººå·¥æ™ºèƒ½ï¼Ÿ",
    "k": 5,
    "similarity_threshold": 0.7,
    "use_cache": true
  }'
```

**å“åº”ç¤ºä¾‹**:
```json
{
  "success": true,
  "question": "ä»€ä¹ˆæ˜¯äººå·¥æ™ºèƒ½ï¼Ÿ",
  "answer": "äººå·¥æ™ºèƒ½æ˜¯è®¡ç®—æœºç§‘å­¦çš„ä¸€ä¸ªåˆ†æ”¯ï¼Œè‡´åŠ›äºåˆ›å»ºèƒ½å¤Ÿæ‰§è¡Œé€šå¸¸éœ€è¦äººç±»æ™ºèƒ½çš„ä»»åŠ¡çš„ç³»ç»Ÿã€‚",
  "context_documents": [
    {
      "content": "äººå·¥æ™ºèƒ½æ˜¯è®¡ç®—æœºç§‘å­¦çš„ä¸€ä¸ªåˆ†æ”¯...",
      "metadata": {
        "source": "ai_intro.pdf",
        "page": 1
      },
      "similarity_score": 0.95,
      "rank": 1
    }
  ],
  "generation_time": 2.5,
  "total_time": 3.2,
  "from_cache": false,
  "model": "qwen3:30b",
  "token_count": {
    "prompt_tokens": 150,
    "completion_tokens": 80,
    "total_tokens": 230
  },
  "retrieval_stats": {
    "retrieved_count": 5,
    "similarity_threshold": 0.7,
    "avg_similarity": 0.85
  }
}
```

#### 6.3.2 æµå¼é—®ç­”

```bash
curl -X POST "http://localhost/api/qa/ask-stream" \
  -H "Content-Type: application/json" \
  -H "Accept: text/event-stream" \
  -d '{
    "question": "è¯¦ç»†è§£é‡Šæœºå™¨å­¦ä¹ çš„æ¦‚å¿µ",
    "k": 3
  }'
```

**æµå¼å“åº”ç¤ºä¾‹**:
```
data: {"type": "start", "message": "å¼€å§‹å¤„ç†é—®é¢˜"}

data: {"type": "retrieval", "retrieved_count": 3}

data: {"type": "generation", "content": "æœºå™¨å­¦ä¹ æ˜¯"}

data: {"type": "generation", "content": "äººå·¥æ™ºèƒ½çš„ä¸€ä¸ª"}

data: {"type": "generation", "content": "é‡è¦åˆ†æ”¯..."}

data: {"type": "end", "total_time": 4.2}
```

#### 6.3.3 æ‰¹é‡é—®ç­”

```bash
curl -X POST "http://localhost/api/qa/batch-ask" \
  -H "Content-Type: application/json" \
  -d '{
    "questions": [
      "ä»€ä¹ˆæ˜¯æœºå™¨å­¦ä¹ ï¼Ÿ",
      "æ·±åº¦å­¦ä¹ æœ‰ä»€ä¹ˆç‰¹ç‚¹ï¼Ÿ",
      "ç¥ç»ç½‘ç»œå¦‚ä½•å·¥ä½œï¼Ÿ"
    ],
    "k": 5,
    "use_cache": true
  }'
```

#### 6.3.4 é—®ç­”å†å²

**è·å–é—®ç­”å†å²**:
```bash
curl "http://localhost/api/qa/history?limit=20&offset=0"
```

**æäº¤åé¦ˆ**:
```bash
curl -X POST "http://localhost/api/qa/feedback" \
  -H "Content-Type: application/json" \
  -d '{
    "question": "ä»€ä¹ˆæ˜¯äººå·¥æ™ºèƒ½ï¼Ÿ",
    "answer": "äººå·¥æ™ºèƒ½æ˜¯...",
    "rating": 5,
    "feedback": "å›ç­”å¾ˆå‡†ç¡®å’Œè¯¦ç»†"
  }'
```

### 6.4 ç³»ç»Ÿç®¡ç†æ“ä½œ

#### 6.4.1 ç³»ç»Ÿç›‘æ§

**å¥åº·æ£€æŸ¥**:
```bash
curl "http://localhost/api/system/health"
```

**ç³»ç»Ÿç»Ÿè®¡**:
```bash
curl "http://localhost/api/system/stats"
```

**PrometheusæŒ‡æ ‡**:
```bash
curl "http://localhost/api/system/metrics"
```

#### 6.4.2 é…ç½®ç®¡ç†

**è·å–é…ç½®**:
```bash
curl "http://localhost/api/system/config"
```

**æ›´æ–°é…ç½®**:
```bash
curl -X PUT "http://localhost/api/system/config" \
  -H "Content-Type: application/json" \
  -d '{
    "chunk_size": 1200,
    "temperature": 0.8,
    "retrieval_k": 8
  }'
```

#### 6.4.3 ç¼“å­˜ç®¡ç†

**æ¸…é™¤ç¼“å­˜**:
```bash
curl -X DELETE "http://localhost/api/system/cache?pattern=qa:*"
```

**ç¼“å­˜ç»Ÿè®¡**:
```bash
curl "http://localhost/api/system/cache/stats"
```

### 6.5 Webç•Œé¢æ“ä½œ

#### 6.5.1 æ–‡æ¡£ä¸Šä¼ ç•Œé¢

1. è®¿é—® `http://localhost/docs`
2. æ‰¾åˆ° "Documents" éƒ¨åˆ†
3. ç‚¹å‡» "POST /api/documents/upload"
4. ç‚¹å‡» "Try it out"
5. é€‰æ‹©æ–‡ä»¶å¹¶ä¸Šä¼ 

#### 6.5.2 é—®ç­”æµ‹è¯•ç•Œé¢

1. åœ¨APIæ–‡æ¡£ä¸­æ‰¾åˆ° "QA" éƒ¨åˆ†
2. ç‚¹å‡» "POST /api/qa/ask"
3. ç‚¹å‡» "Try it out"
4. è¾“å…¥é—®é¢˜JSONæ ¼å¼æ•°æ®
5. ç‚¹å‡» "Execute" æŸ¥çœ‹ç»“æœ

#### 6.5.3 ç›‘æ§ç•Œé¢

**Grafanaä»ªè¡¨æ¿**:
1. è®¿é—® `http://localhost:3000`
2. é»˜è®¤ç”¨æˆ·å/å¯†ç : admin/admin
3. æŸ¥çœ‹é¢„é…ç½®çš„RAGç³»ç»Ÿä»ªè¡¨æ¿

**PrometheusæŒ‡æ ‡**:
1. è®¿é—® `http://localhost:9090`
2. åœ¨æŸ¥è¯¢æ¡†ä¸­è¾“å…¥æŒ‡æ ‡åç§°
3. æŸ¥çœ‹å®æ—¶æŒ‡æ ‡æ•°æ®

---

## 7. APIæ¥å£æ–‡æ¡£

### 7.1 æ¥å£æ¦‚è§ˆ

RAGç³»ç»Ÿæä¾›å®Œæ•´çš„RESTful APIæ¥å£ï¼Œæ”¯æŒæ–‡æ¡£ç®¡ç†ã€æ™ºèƒ½é—®ç­”ã€ç³»ç»Ÿç®¡ç†ç­‰åŠŸèƒ½ã€‚æ‰€æœ‰æ¥å£éƒ½æ”¯æŒJSONæ ¼å¼çš„è¯·æ±‚å’Œå“åº”ã€‚

**åŸºç¡€URL**: `http://localhost/api`

**è®¤è¯æ–¹å¼**: 
- API Key (Header: `X-API-Key` æˆ– `Authorization: Bearer <token>`)

**é€šç”¨å“åº”æ ¼å¼**:
```json
{
  "success": true,
  "message": "æ“ä½œæˆåŠŸ",
  "data": {},
  "timestamp": "2023-12-01T12:34:56Z",
  "request_id": "uuid-string"
}
```

### 7.2 æ–‡æ¡£ç®¡ç†æ¥å£

#### 7.2.1 ä¸Šä¼ æ–‡æ¡£

**æ¥å£**: `POST /api/documents/upload`

**æè¿°**: ä¸Šä¼ å•ä¸ªæ–‡æ¡£æ–‡ä»¶

**è¯·æ±‚å‚æ•°**:
- `file` (file, required): è¦ä¸Šä¼ çš„æ–‡æ¡£æ–‡ä»¶

**æ”¯æŒæ ¼å¼**: PDF, TXT, MD, DOCX

**æ–‡ä»¶å¤§å°é™åˆ¶**: 50MB

**è¯·æ±‚ç¤ºä¾‹**:
```bash
curl -X POST "http://localhost/api/documents/upload" \
  -H "X-API-Key: your-api-key" \
  -F "file=@document.pdf"
```

**å“åº”ç¤ºä¾‹**:
```json
{
  "success": true,
  "message": "æ–‡ä»¶ä¸Šä¼ æˆåŠŸ",
  "filename": "document.pdf",
  "file_path": "/app/data/uploads/document_20231201_123456.pdf",
  "file_size": 1048576,
  "file_hash": "abc123def456",
  "upload_time": "2023-12-01T12:34:56Z"
}
```

#### 7.2.2 æ‰¹é‡ä¸Šä¼ æ–‡æ¡£

**æ¥å£**: `POST /api/documents/batch-upload`

**æè¿°**: æ‰¹é‡ä¸Šä¼ å¤šä¸ªæ–‡æ¡£æ–‡ä»¶

**è¯·æ±‚å‚æ•°**:
- `files` (file[], required): è¦ä¸Šä¼ çš„æ–‡æ¡£æ–‡ä»¶åˆ—è¡¨

**è¯·æ±‚ç¤ºä¾‹**:
```bash
curl -X POST "http://localhost/api/documents/batch-upload" \
  -H "X-API-Key: your-api-key" \
  -F "files=@doc1.pdf" \
  -F "files=@doc2.txt"
```

**å“åº”ç¤ºä¾‹**:
```json
{
  "success": true,
  "message": "æ‰¹é‡ä¸Šä¼ å®Œæˆ",
  "total_files": 2,
  "success_count": 2,
  "failed_count": 0,
  "results": [
    {
      "filename": "doc1.pdf",
      "success": true,
      "file_path": "/app/data/uploads/doc1_20231201_123456.pdf"
    },
    {
      "filename": "doc2.txt", 
      "success": true,
      "file_path": "/app/data/uploads/doc2_20231201_123457.txt"
    }
  ]
}
```

#### 7.2.3 å¤„ç†æ–‡æ¡£

**æ¥å£**: `POST /api/documents/process`

**æè¿°**: å¤„ç†å·²ä¸Šä¼ çš„æ–‡æ¡£ï¼Œè¿›è¡Œåˆ†å—å’Œå‘é‡åŒ–

**è¯·æ±‚å‚æ•°**:
```json
{
  "file_path": "string (required)",
  "chunk_size": "integer (optional, default: 1000)",
  "chunk_overlap": "integer (optional, default: 200)"
}
```

**è¯·æ±‚ç¤ºä¾‹**:
```bash
curl -X POST "http://localhost/api/documents/process" \
  -H "Content-Type: application/json" \
  -H "X-API-Key: your-api-key" \
  -d '{
    "file_path": "/app/data/uploads/document.pdf",
    "chunk_size": 1000,
    "chunk_overlap": 200
  }'
```

**å“åº”ç¤ºä¾‹**:
```json
{
  "success": true,
  "message": "æ–‡æ¡£å¤„ç†å®Œæˆ",
  "file_path": "/app/data/uploads/document.pdf",
  "original_docs": 1,
  "chunks_created": 15,
  "stored_count": 15,
  "processing_time": 12.5,
  "skipped_count": 0,
  "embedding_model": "BAAI/bge-large-zh-v1.5"
}
```

#### 7.2.4 åˆ é™¤æ–‡æ¡£

**æ¥å£**: `DELETE /api/documents/delete`

**æè¿°**: åˆ é™¤æ–‡æ¡£åŠå…¶ç›¸å…³çš„å‘é‡æ•°æ®

**è¯·æ±‚å‚æ•°**:
```json
{
  "file_path": "string (required)"
}
```

**å“åº”ç¤ºä¾‹**:
```json
{
  "success": true,
  "message": "æ–‡æ¡£åˆ é™¤æˆåŠŸ",
  "file_path": "/app/data/uploads/document.pdf",
  "deleted_count": 15
}
```

#### 7.2.5 æ–‡æ¡£åˆ—è¡¨

**æ¥å£**: `GET /api/documents/list`

**æè¿°**: è·å–å·²ä¸Šä¼ æ–‡æ¡£çš„åˆ—è¡¨

**æŸ¥è¯¢å‚æ•°**:
- `limit` (integer, optional): è¿”å›æ•°é‡é™åˆ¶ï¼Œé»˜è®¤20
- `offset` (integer, optional): åç§»é‡ï¼Œé»˜è®¤0
- `format` (string, optional): æ–‡ä»¶æ ¼å¼è¿‡æ»¤

**å“åº”ç¤ºä¾‹**:
```json
{
  "success": true,
  "total_count": 50,
  "files": [
    {
      "filename": "document1.pdf",
      "file_path": "/app/data/uploads/document1.pdf",
      "file_size": 1048576,
      "upload_time": "2023-12-01T12:34:56Z",
      "processed": true,
      "chunks_count": 15
    }
  ]
}
```

#### 7.2.6 æ”¯æŒçš„æ ¼å¼

**æ¥å£**: `GET /api/documents/formats`

**æè¿°**: è·å–ç³»ç»Ÿæ”¯æŒçš„æ–‡æ¡£æ ¼å¼

**å“åº”ç¤ºä¾‹**:
```json
{
  "success": true,
  "supported_formats": [".pdf", ".txt", ".md", ".docx"],
  "max_file_size": 52428800,
  "description": {
    ".pdf": "PDFæ–‡æ¡£",
    ".txt": "çº¯æ–‡æœ¬æ–‡ä»¶",
    ".md": "Markdownæ–‡æ¡£",
    ".docx": "Wordæ–‡æ¡£"
  }
}
```

#### 7.2.7 æ–‡æ¡£ç»Ÿè®¡

**æ¥å£**: `GET /api/documents/stats`

**æè¿°**: è·å–æ–‡æ¡£å¤„ç†ç»Ÿè®¡ä¿¡æ¯

**å“åº”ç¤ºä¾‹**:
```json
{
  "success": true,
  "document_stats": {
    "total_documents": 100,
    "total_chunks": 1500,
    "total_size": 104857600,
    "processed_documents": 95,
    "pending_documents": 5,
    "formats_distribution": {
      "pdf": 60,
      "txt": 25,
      "md": 10,
      "docx": 5
    }
  }
}
```

### 7.3 é—®ç­”æ¥å£

#### 7.3.1 å•é—®é¢˜é—®ç­”

**æ¥å£**: `POST /api/qa/ask`

**æè¿°**: åŸºäºçŸ¥è¯†åº“å›ç­”å•ä¸ªé—®é¢˜

**è¯·æ±‚å‚æ•°**:
```json
{
  "question": "string (required, 1-1000å­—ç¬¦)",
  "k": "integer (optional, 1-20, default: 5)",
  "similarity_threshold": "float (optional, 0.0-1.0, default: 0.7)",
  "use_cache": "boolean (optional, default: true)"
}
```

**è¯·æ±‚ç¤ºä¾‹**:
```bash
curl -X POST "http://localhost/api/qa/ask" \
  -H "Content-Type: application/json" \
  -H "X-API-Key: your-api-key" \
  -d '{
    "question": "ä»€ä¹ˆæ˜¯äººå·¥æ™ºèƒ½ï¼Ÿ",
    "k": 5,
    "similarity_threshold": 0.7,
    "use_cache": true
  }'
```

**å“åº”ç¤ºä¾‹**:
```json
{
  "success": true,
  "question": "ä»€ä¹ˆæ˜¯äººå·¥æ™ºèƒ½ï¼Ÿ",
  "answer": "äººå·¥æ™ºèƒ½æ˜¯è®¡ç®—æœºç§‘å­¦çš„ä¸€ä¸ªåˆ†æ”¯ï¼Œè‡´åŠ›äºåˆ›å»ºèƒ½å¤Ÿæ‰§è¡Œé€šå¸¸éœ€è¦äººç±»æ™ºèƒ½çš„ä»»åŠ¡çš„ç³»ç»Ÿã€‚",
  "context_documents": [
    {
      "content": "äººå·¥æ™ºèƒ½æ˜¯è®¡ç®—æœºç§‘å­¦çš„ä¸€ä¸ªåˆ†æ”¯...",
      "metadata": {
        "source": "ai_intro.pdf",
        "page": 1,
        "chunk_id": "abc123_0"
      },
      "similarity_score": 0.95,
      "rank": 1
    }
  ],
  "generation_time": 2.5,
  "total_time": 3.2,
  "from_cache": false,
  "model": "qwen3:30b",
  "token_count": {
    "prompt_tokens": 150,
    "completion_tokens": 80,
    "total_tokens": 230
  },
  "retrieval_stats": {
    "retrieved_count": 5,
    "similarity_threshold": 0.7,
    "avg_similarity": 0.85,
    "max_similarity": 0.95
  }
}
```

#### 7.3.2 æµå¼é—®ç­”

**æ¥å£**: `POST /api/qa/ask-stream`

**æè¿°**: æµå¼è¿”å›é—®ç­”ç»“æœï¼Œæ”¯æŒServer-Sent Events

**è¯·æ±‚å‚æ•°**: åŒå•é—®é¢˜é—®ç­”

**è¯·æ±‚ç¤ºä¾‹**:
```bash
curl -X POST "http://localhost/api/qa/ask-stream" \
  -H "Content-Type: application/json" \
  -H "Accept: text/event-stream" \
  -H "X-API-Key: your-api-key" \
  -d '{
    "question": "è¯¦ç»†è§£é‡Šæœºå™¨å­¦ä¹ çš„æ¦‚å¿µ",
    "k": 3
  }'
```

**å“åº”æ ¼å¼**: Server-Sent Events
```
data: {"type": "start", "message": "å¼€å§‹å¤„ç†é—®é¢˜", "question": "è¯¦ç»†è§£é‡Šæœºå™¨å­¦ä¹ çš„æ¦‚å¿µ"}

data: {"type": "retrieval", "retrieved_count": 3, "avg_similarity": 0.85}

data: {"type": "generation", "content": "æœºå™¨å­¦ä¹ æ˜¯", "partial": true}

data: {"type": "generation", "content": "äººå·¥æ™ºèƒ½çš„ä¸€ä¸ª", "partial": true}

data: {"type": "generation", "content": "é‡è¦åˆ†æ”¯ï¼Œå®ƒä½¿è®¡ç®—æœºèƒ½å¤Ÿä»æ•°æ®ä¸­å­¦ä¹ å¹¶åšå‡ºé¢„æµ‹æˆ–å†³ç­–ã€‚", "partial": false}

data: {"type": "end", "total_time": 4.2, "token_count": {"total_tokens": 180}}
```

#### 7.3.3 æ‰¹é‡é—®ç­”

**æ¥å£**: `POST /api/qa/batch-ask`

**æè¿°**: æ‰¹é‡å¤„ç†å¤šä¸ªé—®é¢˜

**è¯·æ±‚å‚æ•°**:
```json
{
  "questions": ["string array (required, 1-10ä¸ªé—®é¢˜)"],
  "k": "integer (optional, default: 5)",
  "similarity_threshold": "float (optional, default: 0.7)",
  "use_cache": "boolean (optional, default: true)"
}
```

**è¯·æ±‚ç¤ºä¾‹**:
```bash
curl -X POST "http://localhost/api/qa/batch-ask" \
  -H "Content-Type: application/json" \
  -H "X-API-Key: your-api-key" \
  -d '{
    "questions": [
      "ä»€ä¹ˆæ˜¯æœºå™¨å­¦ä¹ ï¼Ÿ",
      "æ·±åº¦å­¦ä¹ æœ‰ä»€ä¹ˆç‰¹ç‚¹ï¼Ÿ",
      "ç¥ç»ç½‘ç»œå¦‚ä½•å·¥ä½œï¼Ÿ"
    ],
    "k": 5,
    "use_cache": true
  }'
```

**å“åº”ç¤ºä¾‹**:
```json
{
  "success": true,
  "total_questions": 3,
  "processing_time": 8.5,
  "results": [
    {
      "success": true,
      "question": "ä»€ä¹ˆæ˜¯æœºå™¨å­¦ä¹ ï¼Ÿ",
      "answer": "æœºå™¨å­¦ä¹ æ˜¯äººå·¥æ™ºèƒ½çš„ä¸€ä¸ªåˆ†æ”¯...",
      "context_documents": [...],
      "total_time": 2.8
    },
    {
      "success": true,
      "question": "æ·±åº¦å­¦ä¹ æœ‰ä»€ä¹ˆç‰¹ç‚¹ï¼Ÿ",
      "answer": "æ·±åº¦å­¦ä¹ å…·æœ‰ä»¥ä¸‹ç‰¹ç‚¹...",
      "context_documents": [...],
      "total_time": 3.1
    }
  ]
}
```

#### 7.3.4 é—®ç­”å†å²

**æ¥å£**: `GET /api/qa/history`

**æè¿°**: è·å–é—®ç­”å†å²è®°å½•

**æŸ¥è¯¢å‚æ•°**:
- `limit` (integer, optional): è¿”å›æ•°é‡ï¼Œé»˜è®¤20
- `offset` (integer, optional): åç§»é‡ï¼Œé»˜è®¤0
- `start_date` (string, optional): å¼€å§‹æ—¥æœŸ (YYYY-MM-DD)
- `end_date` (string, optional): ç»“æŸæ—¥æœŸ (YYYY-MM-DD)

**å“åº”ç¤ºä¾‹**:
```json
{
  "success": true,
  "total_count": 150,
  "history": [
    {
      "id": "uuid-string",
      "question": "ä»€ä¹ˆæ˜¯äººå·¥æ™ºèƒ½ï¼Ÿ",
      "answer": "äººå·¥æ™ºèƒ½æ˜¯...",
      "timestamp": "2023-12-01T12:34:56Z",
      "response_time": 2.5,
      "from_cache": false,
      "rating": 5
    }
  ]
}
```

#### 7.3.5 é—®é¢˜å»ºè®®

**æ¥å£**: `GET /api/qa/suggestions`

**æè¿°**: æ ¹æ®è¾“å…¥è·å–é—®é¢˜å»ºè®®

**æŸ¥è¯¢å‚æ•°**:
- `query` (string, required): æŸ¥è¯¢å…³é”®è¯
- `limit` (integer, optional): è¿”å›æ•°é‡ï¼Œé»˜è®¤5

**å“åº”ç¤ºä¾‹**:
```json
{
  "success": true,
  "query": "æœºå™¨å­¦ä¹ ",
  "suggestions": [
    "ä»€ä¹ˆæ˜¯æœºå™¨å­¦ä¹ ï¼Ÿ",
    "æœºå™¨å­¦ä¹ æœ‰å“ªäº›ç±»å‹ï¼Ÿ",
    "æœºå™¨å­¦ä¹ çš„åº”ç”¨é¢†åŸŸæœ‰å“ªäº›ï¼Ÿ",
    "å¦‚ä½•å¼€å§‹å­¦ä¹ æœºå™¨å­¦ä¹ ï¼Ÿ",
    "æœºå™¨å­¦ä¹ å’Œæ·±åº¦å­¦ä¹ çš„åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ"
  ]
}
```

#### 7.3.6 æäº¤åé¦ˆ

**æ¥å£**: `POST /api/qa/feedback`

**æè¿°**: å¯¹é—®ç­”ç»“æœæäº¤åé¦ˆ

**è¯·æ±‚å‚æ•°**:
```json
{
  "question": "string (required)",
  "answer": "string (required)",
  "rating": "integer (required, 1-5)",
  "feedback": "string (optional)"
}
```

**å“åº”ç¤ºä¾‹**:
```json
{
  "success": true,
  "message": "åé¦ˆæäº¤æˆåŠŸ",
  "feedback_id": "uuid-string",
  "timestamp": "2023-12-01T12:34:56Z"
}
```

#### 7.3.7 é—®ç­”ç»Ÿè®¡

**æ¥å£**: `GET /api/qa/stats`

**æè¿°**: è·å–é—®ç­”ç³»ç»Ÿç»Ÿè®¡ä¿¡æ¯

**å“åº”ç¤ºä¾‹**:
```json
{
  "success": true,
  "qa_stats": {
    "total_questions": 1000,
    "avg_response_time": 2.5,
    "cache_hit_rate": 0.65,
    "success_rate": 0.95,
    "popular_questions": [
      "ä»€ä¹ˆæ˜¯äººå·¥æ™ºèƒ½ï¼Ÿ",
      "æœºå™¨å­¦ä¹ å¦‚ä½•å·¥ä½œï¼Ÿ"
    ]
  },
  "settings": {
    "embedding_model": "BAAI/bge-large-zh-v1.5",
    "llm_model": "qwen3:30b",
    "default_k": 5,
    "default_threshold": 0.7
  }
}
```

### 7.4 ç³»ç»Ÿç®¡ç†æ¥å£

#### 7.4.1 å¥åº·æ£€æŸ¥

**æ¥å£**: `GET /api/system/health`

**æè¿°**: æ£€æŸ¥ç³»ç»Ÿå„ç»„ä»¶å¥åº·çŠ¶æ€

**å“åº”ç¤ºä¾‹**:
```json
{
  "success": true,
  "status": "healthy",
  "timestamp": "2023-12-01T12:34:56Z",
  "components": {
    "vector_database": {
      "status": "healthy",
      "response_time": 0.05,
      "document_count": 1500
    },
    "llm": {
      "status": "healthy",
      "model": "qwen3:30b",
      "response_time": 0.1
    },
    "cache": {
      "status": "healthy",
      "hit_rate": 0.65,
      "memory_usage": "45%"
    },
    "embedding_model": {
      "status": "healthy",
      "model": "BAAI/bge-large-zh-v1.5",
      "device": "cuda"
    }
  },
  "overall_health": "healthy"
}
```

#### 7.4.2 ç³»ç»Ÿç»Ÿè®¡

**æ¥å£**: `GET /api/system/stats`

**æè¿°**: è·å–ç³»ç»Ÿè¯¦ç»†ç»Ÿè®¡ä¿¡æ¯

**å“åº”ç¤ºä¾‹**:
```json
{
  "success": true,
  "system_info": {
    "app_name": "RAGçŸ¥è¯†åº“é—®ç­”ç³»ç»Ÿ",
    "app_version": "2.0.0",
    "python_version": "3.9.18",
    "startup_time": "2023-12-01T10:00:00Z",
    "uptime": "2h 34m 56s",
    "initialized": true
  },
  "document_processor": {
    "total_documents": 100,
    "total_chunks": 1500,
    "embedding_model": "BAAI/bge-large-zh-v1.5",
    "supported_formats": [".pdf", ".txt", ".md", ".docx"]
  },
  "qa_processor": {
    "total_questions": 1000,
    "embedding_model": "BAAI/bge-large-zh-v1.5",
    "llm_model": "qwen3:30b",
    "cache_enabled": true
  },
  "metrics": {
    "cache_hit_rate": 0.65,
    "cache_hits": 650,
    "cache_misses": 350,
    "avg_response_time": 2.5,
    "system_cpu_percent": 45.2,
    "system_memory_percent": 60.1,
    "system_disk_percent": 30.5
  },
  "supported_formats": [".pdf", ".txt", ".md", ".docx"]
}
```

#### 7.4.3 PrometheusæŒ‡æ ‡

**æ¥å£**: `GET /api/system/metrics`

**æè¿°**: è·å–Prometheusæ ¼å¼çš„ç›‘æ§æŒ‡æ ‡

**å“åº”æ ¼å¼**: text/plain

**å“åº”ç¤ºä¾‹**:
```
# HELP rag_requests_total Total number of requests
# TYPE rag_requests_total counter
rag_requests_total{endpoint="/api/qa/ask",method="POST",status="success"} 1000

# HELP rag_request_duration_seconds Request duration in seconds
# TYPE rag_request_duration_seconds histogram
rag_request_duration_seconds_bucket{endpoint="/api/qa/ask",le="1.0"} 500
rag_request_duration_seconds_bucket{endpoint="/api/qa/ask",le="2.0"} 800
rag_request_duration_seconds_bucket{endpoint="/api/qa/ask",le="+Inf"} 1000

# HELP rag_cache_hit_rate Cache hit rate
# TYPE rag_cache_hit_rate gauge
rag_cache_hit_rate 0.65
```

#### 7.4.4 é…ç½®ç®¡ç†

**è·å–é…ç½®**: `GET /api/system/config`

**å“åº”ç¤ºä¾‹**:
```json
{
  "success": true,
  "config": {
    "app_name": "RAGçŸ¥è¯†åº“é—®ç­”ç³»ç»Ÿ",
    "app_version": "2.0.0",
    "chunk_size": 1000,
    "chunk_overlap": 200,
    "retrieval_k": 5,
    "similarity_threshold": 0.7,
    "max_tokens": 2000,
    "temperature": 0.7,
    "cache_ttl": 3600,
    "max_file_size": 52428800
  }
}
```

**æ›´æ–°é…ç½®**: `PUT /api/system/config`

**è¯·æ±‚å‚æ•°**:
```json
{
  "chunk_size": "integer (optional, 100-5000)",
  "chunk_overlap": "integer (optional, 0-500)",
  "retrieval_k": "integer (optional, 1-20)",
  "similarity_threshold": "float (optional, 0.0-1.0)",
  "temperature": "float (optional, 0.0-2.0)",
  "cache_ttl": "integer (optional, 60-86400)"
}
```

#### 7.4.5 ç³»ç»Ÿæ§åˆ¶

**åˆå§‹åŒ–ç³»ç»Ÿ**: `POST /api/system/initialize`

**å…³é—­ç³»ç»Ÿ**: `POST /api/system/shutdown`

**ç‰ˆæœ¬ä¿¡æ¯**: `GET /api/system/version`

**æ¸…é™¤ç¼“å­˜**: `DELETE /api/system/cache`

### 7.5 é”™è¯¯å¤„ç†

#### 7.5.1 é”™è¯¯å“åº”æ ¼å¼

```json
{
  "success": false,
  "message": "é”™è¯¯æè¿°",
  "error": "é”™è¯¯ç±»å‹",
  "detail": "è¯¦ç»†é”™è¯¯ä¿¡æ¯",
  "timestamp": "2023-12-01T12:34:56Z",
  "request_id": "uuid-string"
}
```

#### 7.5.2 å¸¸è§é”™è¯¯ç 

| HTTPçŠ¶æ€ç  | é”™è¯¯ç±»å‹ | æè¿° |
|-----------|----------|------|
| 400 | Bad Request | è¯·æ±‚å‚æ•°é”™è¯¯ |
| 401 | Unauthorized | æœªæˆæƒè®¿é—® |
| 403 | Forbidden | æƒé™ä¸è¶³ |
| 404 | Not Found | èµ„æºä¸å­˜åœ¨ |
| 413 | Payload Too Large | æ–‡ä»¶è¿‡å¤§ |
| 415 | Unsupported Media Type | ä¸æ”¯æŒçš„æ–‡ä»¶æ ¼å¼ |
| 422 | Unprocessable Entity | æ•°æ®éªŒè¯å¤±è´¥ |
| 429 | Too Many Requests | è¯·æ±‚è¿‡äºé¢‘ç¹ |
| 500 | Internal Server Error | æœåŠ¡å™¨å†…éƒ¨é”™è¯¯ |
| 503 | Service Unavailable | æœåŠ¡ä¸å¯ç”¨ |

#### 7.5.3 é”™è¯¯å¤„ç†ç¤ºä¾‹

```bash
# æ–‡ä»¶æ ¼å¼ä¸æ”¯æŒ
curl -X POST "http://localhost/api/documents/upload" \
  -F "file=@document.xyz"

# å“åº”
{
  "success": false,
  "message": "ä¸æ”¯æŒçš„æ–‡ä»¶æ ¼å¼",
  "error": "UnsupportedFileFormat",
  "detail": "ç³»ç»Ÿä»…æ”¯æŒ PDF, TXT, MD, DOCX æ ¼å¼",
  "timestamp": "2023-12-01T12:34:56Z"
}
```

### 7.6 APIä½¿ç”¨æœ€ä½³å®è·µ

#### 7.6.1 è®¤è¯å’Œå®‰å…¨

1. **ä½¿ç”¨HTTPS**: ç”Ÿäº§ç¯å¢ƒå¿…é¡»ä½¿ç”¨HTTPS
2. **ä¿æŠ¤APIå¯†é’¥**: ä¸è¦åœ¨å®¢æˆ·ç«¯ä»£ç ä¸­ç¡¬ç¼–ç APIå¯†é’¥